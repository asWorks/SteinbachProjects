<Page x:Class="ProjektDB.MainWindow" 
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
       Title="MainWindow" Height="Auto" Width="Auto" Loaded="Page_Loaded" mc:Ignorable="d" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:local="clr-namespace:ProjektDB"
      xmlns:tools="clr-namespace:ProjektDB.Tools"
      xmlns:controls="clr-namespace:ProjektDB.UserControls"
      xmlns:c1="http://schemas.componentone.com/winfx/2006/xaml"
      xmlns:gl="clr-namespace:System.Globalization;assembly=mscorlib"
      xmlns:uc="clr-namespace:CommonTools.UserControls;assembly=CommonTools"
      xmlns:ctv="clr-namespace:CommonTools.Views;assembly=CommonTools"
      Language="de-DE" >
    <Page.Resources>
        <CollectionViewSource x:Key="Projekt_ViewSource"/>
        <CollectionViewSource x:Key="ProjektVerlauf_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_verlauf'}" />
        <CollectionViewSource x:Key="AnlagenTyp_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_anlagentyp'}" />
        <!--<CollectionViewSource x:Key="Rechnungen_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_ausgang_rechnung'}" />-->
        <CollectionViewSource x:Key="AnlagenLieferzeit_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_anlage_lieferzeit'}" />
        <CollectionViewSource x:Key="ProjektRechnung_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_rechnung'}" />
        <CollectionViewSource x:Key="AusgangsRechnungen_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_ausgang_rechnung'}" />
        <CollectionViewSource x:Key="ErsatzteileGutschrift_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_ersatzteile_gutschrift'}" />
        <CollectionViewSource x:Key="LieferantenRechnungen_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_lieferant_rechnung'}" />
        <CollectionViewSource x:Key="LieferantenGutschriften_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_lieferant_grechnung'}" />
        <CollectionViewSource x:Key="AusgangsGutschriften_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_ausgang_grechnung'}" />
        <CollectionViewSource x:Key="Aggregate_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projektAggregat'}"/>
        <CollectionViewSource x:Key="SI_RgKunde_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_si_rgkunde'}" />
        <CollectionViewSource x:Key="SI_RgLieferant_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_si_rglieferant'}" />
        <CollectionViewSource x:Key="SI_GSKunde_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_si_gutschriftkunde'}" />
        <CollectionViewSource x:Key="SI_GSLieferant_ViewSource" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_si_gutschriftlieferant'}" />
        <CollectionViewSource x:Key="Projekt_RechnungenKunde" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_rechnungkunde'}" />
        <CollectionViewSource x:Key="Projekt_GutschriftenKunde" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_gutschriftkunde'}" />
        <CollectionViewSource x:Key="Projekt_RechnungenLieferant" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_rechnunglieferant'}" />
        <CollectionViewSource x:Key="Projekt_GutschriftenLieferant" Source="{Binding Source={StaticResource Projekt_ViewSource}, Path='projekt_gutschriftlieferant'}" />
        <CollectionViewSource x:Key="AggregateLookup" />
        <CollectionViewSource x:Key="FirmaLookup" />
        <CollectionViewSource x:Key="KundenLookup" />
        <CollectionViewSource x:Key="ReklamationLookUp"/>
        <CollectionViewSource x:Key="PersonLookUp"/>
        <CollectionViewSource x:Key="UrsprungLookUp"/>
        <CollectionViewSource x:Key="SchiffLookup"/>
        <CollectionViewSource x:Key="TypLookUp"/>
        <CollectionViewSource x:Key="KalkulationLookUp"/>
        <CollectionViewSource x:Key="LagerlistenLookUp"/>
        <CollectionViewSource x:Key="WaehrungenLookUp"/>
        <CollectionViewSource x:Key="LieferadressenLookUp"/>
        <CollectionViewSource x:Key="KostenstellenLookUp"/>
        <CollectionViewSource x:Key="SpracheLookUp"/>
        
        <local:PersonIDConverter x:Key="personconverter" />
        <local:CountIndexUpConverter x:Key="CountIndexConverter"/>
        <local:CountIndexUp1Converter x:Key="CountIndexConverter1"/>
        <local:CountIndexUp2Converter x:Key="CountIndexConverter2"/>
        <local:TestMultiValueConverter x:Key="MultiBindConverter"/>
        <DataTemplate x:Key="KostenstellenTemplate">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding id}" MinWidth="50"/>
                <TextBlock Text="{Binding Bezeichnung}"/>
            </StackPanel>
        </DataTemplate>
        <DataTemplate x:Key="AdressenTemplate">
            <StackPanel>
                <StackPanel Orientation="Horizontal">
                    <!--<StackPanel>
                        <TextBlock Text="Standort :"/>
                        <TextBlock Text="{Binding Path=Standort}" MinWidth="100"/>
                    </StackPanel>-->
                    <StackPanel>
                        <TextBlock Text="Gesellschaft Name :"/>
                        <TextBlock Text="{Binding Path=Postfach}" MinWidth="250"/>
                    </StackPanel>
                    <StackPanel>
                        <TextBlock Text="PLZ:"/>
                        <TextBlock Text="{Binding Path=PLZ}" MinWidth="50"/>
                    </StackPanel>
                    <StackPanel>
                        <TextBlock Text="Ort :"/>
                        <TextBlock Text="{Binding Path=Ort}" MinWidth="120"/>
                    </StackPanel>
                    <StackPanel>
                        <TextBlock Text="Straße :"/>
                        <TextBlock Text="{Binding Path=Straße}" MinWidth="120"/>
                    </StackPanel>
                </StackPanel>
                <StackPanel>
                    <TextBlock Text="Zusatzinfo :"/>
                    <TextBlock Text="{Binding Path=Zusatzinfo}" MinWidth="350"/>
                </StackPanel>
            </StackPanel>
        </DataTemplate>
        <Style TargetType="{x:Type controls:LabelAndCheckbox}">
            <Setter Property="StackPanelOrientation" Value="Vertical"/>
            <Setter Property="TextBlockTextAlignment" Value="Center"/>
            <Setter Property="TextBlockMargin" Value="2,5"/>
            <Setter Property="CheckBoxMargin" Value="73,10,73,10"/>
            <Setter Property="TextBlockFontFamily" Value="Calibri"/>
            <Setter Property="TextBlockFontSize" Value="12"/>
        </Style>
        <Style  TargetType="uc:FilteredComboBox_Extended">
            <Setter Property="CBoxWidth" Value="250"/>
            <Setter Property="CBoxHeight" Value="25"/>
            <Setter Property="CBoxMargin" Value="2,2,0,0"/>

        </Style>
        <Style TargetType="{x:Type controls:LabelAndDatepicker}">
            <Setter Property="DatePickerWidth" Value="150"/>
            <Setter Property="StackPanelOrientation" Value="Vertical"/>
            <Setter Property="TextBlockMargin" Value="2,5"/>
            <Setter Property="DatePickerMargin" Value="3" />
            <Setter Property="TextBlockFontFamily" Value="Calibri"/>
            <Setter Property="TextBlockFontSize" Value="12"/>
            <Setter Property="TextBlockTextAlignment" Value="Center"/>
        </Style>
        <Style TargetType="{x:Type controls:BetragWaehrung}">
            <Setter Property="TextBoxMargin" Value="3"/>
            <Setter Property="WaehrungBoxMargin" Value="0,3,3,3"/>
            <Setter Property="StackPanelOrientation" Value="Vertical"/>
            <Setter Property="TextBlockFontFamily" Value="Calibri"/>
            <Setter Property="TextBlockFontSize" Value="12"/>
            <Setter Property="ValueFontFamily" Value="Calibri"/>
            <Setter Property="ValueFontSize" Value="14"/>
            <Setter Property="TextBlockTextAlignment" Value="Center"/>
        </Style>
        <Style TargetType="{x:Type controls:LabelAndText}">
            <Setter Property="TextBoxWidth" Value="150"/>
            <Setter Property="TextBoxMargin" Value="3"/>
            <Setter Property="StackPanelOrientation" Value="Vertical"/>
            <Setter Property="TextBoxTextAlignment" Value="Left"/>
            <Setter Property="TextBlockFontFamily" Value="Calibri"/>
            <Setter Property="TextBlockFontSize" Value="12"/>
            <Setter Property="ValueFontFamily" Value="Calibri"/>
            <Setter Property="ValueFontSize" Value="14"/>
            <Setter Property="TextBlockTextAlignment" Value="Center"/>
        </Style>
        <Style TargetType="{x:Type controls:LabelAndCurrency}">
            <Setter Property="TextBoxWidth" Value="150"/>
            <Setter Property="TextBoxMargin" Value="3"/>
            <Setter Property="StackPanelOrientation" Value="Vertical"/>
            <Setter Property="TextBoxTextAlignment" Value="Right"/>
            <Setter Property="TextBlockFontFamily" Value="Calibri"/>
            <Setter Property="TextBlockFontSize" Value="12"/>
            <Setter Property="ValueFontFamily" Value="Calibri"/>
            <Setter Property="ValueFontSize" Value="14"/>
            <Setter Property="TextBlockTextAlignment" Value="Center"/>
        </Style>
        <Style TargetType="{x:Type uc:LabelAndCurrency}">
            <Setter Property="TextBoxWidth" Value="150"/>
            <Setter Property="TextBoxMargin" Value="3"/>
            <Setter Property="StackPanelOrientation" Value="Vertical"/>
            <Setter Property="TextBoxTextAlignment" Value="Right"/>
            <Setter Property="TextBlockFontFamily" Value="Calibri"/>
            <Setter Property="TextBlockFontSize" Value="12"/>
            <Setter Property="ValueFontFamily" Value="Calibri"/>
            <Setter Property="ValueFontSize" Value="14"/>
            <Setter Property="TextBlockTextAlignment" Value="Center"/>
        </Style>
        <Style TargetType="c1:C1DateTimePicker">
            <Setter Property="EditMode" Value="Date"></Setter>
            <Setter Property="DateFormat" Value="Long"/>
            <Setter Property="AllowNull" Value="True"/>
        </Style>
        <Style TargetType="Button" x:Key="StyleSymbol">
            <Setter Property="Width" Value="20"/>
            <Setter Property="Height" Value="20"/>
            <Setter Property="Background" Value="LemonChiffon"></Setter>
            <Setter Property="Foreground" Value="MidnightBlue"></Setter>
        </Style>
        <Style TargetType="Button">
            <Setter Property="Background" Value="LemonChiffon"></Setter>
            <Setter Property="Foreground" Value="MidnightBlue"></Setter>
            <!--<Setter Property="Width" Value="20"/>-->
            <Setter Property="Margin" Value="3,0,0,0"/>
            <!--<Setter Property="Height" Value="20"/>-->
        </Style>
        <Style TargetType="ComboBox">
            <Setter Property="Background" Value="GhostWhite"/>
            <Setter Property="FontFamily" Value="Calibri" />
            <Setter Property="FontSize" Value="14"/>
        </Style>
        <Style TargetType="TextBox">
            <Setter Property="Height" Value="24" />
            <Setter Property="FontFamily" Value="Calibri" />
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="3,0"/>
            <Setter Property="BorderBrush" Value="Black"/>
        </Style>
        <Style TargetType="DatePicker">
            <Setter Property="Height" Value="30" />
            <Setter Property="Width" Value="150" />
        </Style>
        <Style TargetType="DatePickerTextBox">
            <Setter Property="Text" Value=" " />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontFamily" Value="Calibri"/>
            <Setter Property="TextAlignment" Value="Center"/>
            <Setter Property="Height" Value ="30" />
        </Style>
        <Style TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="FontFamily" Value="Calibri"/>
        </Style>
        <Style TargetType="Label">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="FontFamily" Value="Calibri"/>
            <Setter Property="Foreground" Value="Red"/>
        </Style>
        <Style TargetType="Expander">
            <Setter Property="Foreground"  Value="Black" />
        </Style>
        <Style TargetType="StackPanel">
            <Setter Property="Background" Value="#FFD1DCE8"/>
        </Style>
        <Style TargetType="ListView" >
            <Setter Property="Background" Value="Lavender"/>
        </Style>
        <Style TargetType="CheckBox" x:Key="CheckboxStaticData">
            <Setter Property="FlowDirection" Value="RightToLeft" />
            <Setter Property="Width" Value="120" />
        </Style>
        <Style TargetType="TextBlock" x:Key="TextblockStaticData">
            <Setter Property="FontSize" Value="9" />
            <Setter Property="Margin" Value="3" />
            <Setter Property="Width" Value="120" />
        </Style>
        <Style TargetType="Label" x:Key="LabelStaticData" >
            <Setter Property="FontSize" Value="11" />
            <Setter Property="Margin" Value="3,-5" />
            <Setter Property="Width" Value="120" />
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="Margin" Value="10,-5,0,0"/>

        </Style>
        <Style x:Key="Datepicker_Fest" TargetType="DatePicker">
            <Setter Property="Width" Value="150" />
        </Style>
        <Style TargetType="TextBox" x:Key="TextboxStaticData">
            <Setter Property="Width" Value="120"/>
            <Setter Property="Height" Value="24" />
            <Setter Property="FontFamily" Value="Calibri" />
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="3"/>
            <Setter Property="BorderBrush" Value="Black"/>
        </Style>


        <Style TargetType="ComboBox" x:Key="KostenstellenStyle">
            <Setter Property="Margin"  Value="10,3,13,3"/>
            <Setter Property="Width" Value="240"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Background" Value="White"/>
        </Style>
        <Style TargetType="TextBlock" x:Key="KostenstellenLabel">
            <Setter Property="Margin" Value="25,3,13,6"/>
        </Style>

        <ImageBrush  x:Key="ImageDelete" ImageSource="Images\del.png" />
        <BitmapImage x:Key="BitmapDelete" UriSource="Images\del.png" />
        <BitmapImage x:Key="BitmapPlus" UriSource="Images\plus.png" />
        <BitmapImage x:Key="BitmapTipp" UriSource="Images\tipp.png" />
        <x:Array x:Key="CurrenciesString" Type="tools:ComboBoxItemString">
            <tools:ComboBoxItemString valueString="Euro"/>
            <tools:ComboBoxItemString valueString="NOK"/>
        </x:Array>
        <DataTemplate x:Key="ProjektRechnungenLieferantTemplate">
            <StackPanel>
                <StackPanel>
                    <StackPanel Height="Auto" Orientation="Horizontal">
                        <StackPanel>
                            <controls:LabelAndText TextBlockText="Name :" TextBoxText="{Binding Path=lieferantname, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                            <controls:LabelAndDatepicker TextBlockText="Rechnungsdatum :" DatePickerDateTime="{Binding Path=rechnungsdatum, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                        <StackPanel>
                            <controls:LabelAndText  TextBlockText="Rechnungsnummer :" TextBoxText="{Binding Path=rechnungsnummer, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                            <controls:LabelAndDatepicker TextBlockText="Rechnung fällig :" DatePickerDateTime="{Binding Path=rechnungfaellig, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                        <StackPanel>
                            <controls:BetragWaehrung TextBoxText="{Binding Path=rechnungsbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Rechnungsbetrag :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                         CBoxSelectedValue="{Binding Path=wkz,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                            <controls:LabelAndCurrency TextBlockText="gezahlter Betrag :" TextBoxText="{Binding Path=rechnungseingang, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                        </StackPanel>
                        <StackPanel>
                            <controls:LabelAndCurrency TextBlockText="MWST. :" TextBoxText="{Binding Path=mwstbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                            <controls:LabelAndDatepicker TextBlockText="Rechnung bez. :" DatePickerDateTime="{Binding Path=rechnungbezahlt, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                        <Rectangle Width="10" Height="40" Stroke="Transparent" Fill="Transparent" Margin="15,0,15,0" />
                        <StackPanel>
                            <controls:LabelAndCurrency TextBlockText="EUST Betrag :" TextBoxText="{Binding Path=eustbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                            <controls:LabelAndDatepicker TextBlockText="EUST :" DatePickerDateTime="{Binding Path=eust, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                        <StackPanel>
                            <controls:LabelAndCurrency TextBlockText="Gebühren :" TextBoxText="{Binding Path=gebuehr, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                            <controls:LabelAndCurrency TextBlockText="MWST auf Gebühr :"
                                                                                                    TextBoxText="{Binding Path=mwstaufgebuehr, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}" />
                        </StackPanel>
                        <StackPanel>
                            <controls:LabelAndCurrency StackPanelOrientation="Vertical"  TextBlockText="Zollgebühren :" TextBoxText="{Binding Path= zollgebuehren,Mode=TwoWay,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                            <StackPanel>
                                <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                      IsSynchronizedWithCurrentItem="False"
                                                                                      ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                      SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                      SelectedValuePath="id"
                                                                                      ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                            </StackPanel>
                        </StackPanel>

                        <Button Name="cmdDeleteProjektRechnungLieferant"   Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                            <Image Source="Images\del.png"></Image>
                        </Button>
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </DataTemplate>
    </Page.Resources>
    <ScrollViewer HorizontalScrollBarVisibility="Visible">
        <Grid Name="ProjektDataGrid" DataContext="{StaticResource Projekt_ViewSource}">
            <Grid.RowDefinitions>
                <RowDefinition Height="auto" Name="rdProjekt_Fest" />
                <RowDefinition Height="Auto" Name="rdProjekt_SrollData"/>
            </Grid.RowDefinitions>
            <StackPanel Grid.Row="0"  Orientation="Horizontal">
                <Grid Name="Anfrage" >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="30"/>
                        <RowDefinition Height="35"/>
                        <RowDefinition Height="30"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="25"/>
                        <RowDefinition Height="30"/>
                        <RowDefinition Height="25"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>


                    </Grid.RowDefinitions>
                    <StackPanel Name="spUpperButtons" Grid.Row="0" Orientation="Horizontal">
                        <!--<Menu>
                            <MenuItem Header="Extras">
                                <MenuItem Name="Neu" Click="Neu_Click" Header="Neu"></MenuItem>
                                <MenuItem Name="Login" Header="Login" />
                                <MenuItem Name="Ende" Click="Ende_Click" Header="_Beenden" />
                                <MenuItem Name="brunvoll" Click="brunvoll_Click" Header="Brunvoll"/>
                                <MenuItem Name="jets" Click="jets_Click"  Header="Jets"/>
                                <MenuItem Name="SI" Click="SI_Click"  Header="SI"/>
                                <MenuItem Name="Auftrag" Click="Auftrag_Click"  Header="Auftrag"/>

                            </MenuItem>
                        </Menu>-->
                        <Button Name="Speichern" Click="Save_Click" Height="30" Width="120" Margin="10,5,3,5" Content="Speichern"></Button>
                        <Button Name="btnSaveInitData" Click="btnSaveInitData_Click" Height="30" Width="120" Margin="10,5,0,5" Content="Projekt anlegen" Visibility="Collapsed"></Button>
                        <Button Name="btnClose" Click="btnClose_Click" Height="30" Width="120" Margin="7,5,3,5" Content="Schließen"></Button>
                        <Button Name="btnCancel" Click="btnCancel_Click" Height="30" Width="120" Margin="3,5,3,5" Content="Verwerfen" Visibility="Collapsed"></Button>
                        <!--<Button Name="btnDelete" Click="btnDelete_Click" Height="30" Width="120" Margin="10,5,3,5" Content="Projekt löschen"></Button>-->
                        <!--<Button Name="btnAddCalculation" Click="btnAddCalculation_Click" Height="30" Width="120" Margin="10,5,3,5" Content="Neue Kalkulation" Visibility="Collapsed"></Button>-->
                        <Button Content="Deckblatt drucken" Click="btnDeckblatt_Click" Height="30" Name="btnDeckblatt" Width="120" />
                        <TextBox x:Name="txtFirmenname"  Text="{Binding Path=firmenname,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"  Height="23"  Width="120" Visibility="Hidden" />
                        <!--<Button Content="Anderungen verwerfen" Name="btnRejectChanges" Height="30" Width="120" Click="btnRejectChanges_Click" />-->
                    </StackPanel>
                    <StackPanel Grid.Row="1" >
                        <StackPanel Orientation="Horizontal" >
                            <TextBlock Text="{Binding Path=FirmenNr}" Width="50" x:Name="tblFirmenNr" HorizontalAlignment="Left" Foreground="DarkGray" FontSize="14" Margin="15,0,0,0"/>
                        </StackPanel>
                        <StackPanel Grid.Row="1" Orientation="Horizontal">
                            <!--<controls:FilteredComboBox_Extended CBoxItemssource="{Binding Source={StaticResource FirmaLookup}}" x:Name="Firma_FCB_X" 
                              CBoxSelectedValue="{Binding Path=FirmenNr,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}"
                              CBoxSelectedValuePath="KdNr"
                              CBoxDisplayMemberPath="name" 
                              OnFcb_SelectionChanged="Firma_FCB_X_OnFcb_SelectionChanged"
                              CBoxMargin="10,3,3,3" CBoxWidth="120" CBoxHeight="23"/>-->
                            <ComboBox ItemsSource="{Binding Source={StaticResource FirmaLookup}}" x:Name="Firma_FCB_X" IsSynchronizedWithCurrentItem="False"
                              SelectedValue="{Binding Path=FirmenNr,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}"
                              SelectedValuePath="KdNr"
                              DisplayMemberPath="name" 
                              SelectionChanged="Firma_FCB_X_OnFcb_SelectionChanged"
                              Margin="10,3,3,3" Width="120" Height="23"/>
                            <!--<ComboBox Height="23" HorizontalAlignment="Left" Name="cboFirma" VerticalAlignment="Center" Margin="10,3,3,3" Width="120"
                                      IsSynchronizedWithCurrentItem="False"
                                      ItemsSource="{Binding Source={StaticResource FirmaLookup}}" 
                                      SelectedValue ="{Binding Path=FirmenNr,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                      SelectedValuePath="KdNr"
                                      DisplayMemberPath="name" SelectionChanged="cboFirma_SelectionChanged" />-->
                            <!--<ComboBox Height="23" HorizontalAlignment="Left" Name="cboSchiff" VerticalAlignment="Center" Margin="10,3,3,3" Width="239"
                                      IsSynchronizedWithCurrentItem="False"
                                     ItemsSource="{Binding Source={StaticResource SchiffLookup}}" 
                                      SelectedValue ="{Binding Path=projekt_schiff,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                      SelectedValuePath="name"
                                      DisplayMemberPath="name" Visibility="Visible" />-->
                            <ComboBox Height="23" HorizontalAlignment="Left" Name="cboType" VerticalAlignment="Center" Margin="10,3,3,3" Width="120"
                                      IsSynchronizedWithCurrentItem="False"
                                      ItemsSource="{Binding Source={StaticResource TypLookUp}}" 
                                      SelectedValue ="{Binding Path=type,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                      SelectedValuePath="Projekttyp"
                                      DisplayMemberPath="Projekttyp" SelectionChanged="cboType_SelectionChanged" />
                            <TextBox x:Name="txtProjektnummer" Style="{StaticResource TextboxStaticData}"  Text="{Binding Path= projektnummer,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" AutoWordSelection="False" BorderBrush="Black" MaxLength="16" />
                            <TextBox x:Name="txtBrunvollprojektnummer" Style="{StaticResource TextboxStaticData}" Text="{Binding Path= brunvollprojektnr,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" MaxLength="64" />
                            <TextBox Style="{StaticResource TextboxStaticData}" Text="{Binding Path= orderno,Mode=TwoWay}" Name="txtOffernummer" MaxLength="64" />
                            <!--<DatePicker x:Name="dtpDatum" Margin="3,3"  SelectedDate="{Binding Path=datum, Mode=TwoWay, ValidatesOnExceptions=true,  NotifyOnValidationError=true}" Height="25"   Width="142"/>-->
                            <c1:C1DateTimePicker x:Name="dtpDatum" Margin="3,3"  DateTime="{Binding Path=datum, Mode=TwoWay, ValidatesOnExceptions=true,  NotifyOnValidationError=true}" Height="25"   Width="Auto" FontSize="11" />
                            <!--<DatePicker x:Name="dtpDatum" Margin="3,3"  SelectedDate="{Binding Path=datum, Mode=TwoWay, ValidatesOnExceptions=true,  NotifyOnValidationError=true}" Height="25"   Width="142" />-->
                            <!--<Button Name="addProjekt" Click="addProjekt_Click" Width="120" Margin="3">Neu Projekt</Button>-->
                        </StackPanel>
                    </StackPanel>
                    <StackPanel Grid.Row="2" Orientation="Vertical">
                        <StackPanel Orientation="Horizontal">
                            <Label Content="Firmenname:" Style="{StaticResource LabelStaticData}" Margin="10,-5,0,0"/>
                            <Label Content="Typ:" Style="{StaticResource LabelStaticData}" Name="lblType" />
                            <Label Content="Proj.-Nr:" Style="{StaticResource LabelStaticData}"/>
                            <Label Content="Unit Nr.:" Style="{StaticResource LabelStaticData}" Name="lblUnitNr"/>
                            <Label Content="Offer Nr:" Style="{StaticResource LabelStaticData}" Name="lblOfferNr"/>
                            <Label Content="Datum :" Style="{StaticResource LabelStaticData}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <StackPanel >
                                <TextBlock Margin="150,0,0,0" Name="tbHostHyperlinkServive" HorizontalAlignment="Center" FontSize="13">
                            <Hyperlink Name="hylMakeService" Click="hylMakeService_Click">
                                <TextBlock Text ="Service anlegen." Name="tbHypelinkServiceText" FontSize="14">
                                    
                                </TextBlock>
                            </Hyperlink>
                        </TextBlock>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                    <StackPanel Name="SP3" Grid.Row="3" Orientation="Horizontal" Margin="0" Background="#FFE1EEF0">
                        <CheckBox Name="chkAnfrage" Style="{StaticResource CheckboxStaticData}" Margin ="-50,7" Content="" IsChecked ="{Binding Path=anfrage, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" FlowDirection="RightToLeft" Padding="4,0,0,0" OverridesDefaultStyle="False" />
                        <CheckBox Name="chkAuftrag" Style="{StaticResource CheckboxStaticData}" Content="" Margin="50,7"  IsChecked ="{Binding Path=auftrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" Click="chkAuftrag_Click"/>
                        <CheckBox Name="chkSI" Style="{StaticResource CheckboxStaticData}" Content="" Margin="-40,7"  IsChecked ="{Binding Path=si, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" Click="chkSI_Click"/>
                        <RadioButton Content="" Height="16" Name="rbLand" GroupName="Anlagen" Margin="153,0,0,0" IsChecked="{Binding Path=landx, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" Checked="rbLand_Checked" />
                        <RadioButton Content="" Height="16" Name="rbSchiff" GroupName="Anlagen" Margin="110,0,0,0" IsChecked="{Binding Path=schiff, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" Checked="rbSchiff_Checked" />
                        <CheckBox Name="chkUmsatzsteuer" IsChecked="{Binding istUmsatzsteuerbefreit}" Style="{StaticResource CheckboxStaticData}" Margin="0,7,0,0" />
                        <!--<CheckBox Name="chkLand" Style="{StaticResource CheckboxStaticData}" Content="" Margin="40,7"  IsChecked ="{Binding Path=land, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                        <CheckBox Name="chkSchiff" Style="{StaticResource CheckboxStaticData}" Content="" Margin="-30,7,40,0"  IsChecked ="{Binding Path=schiff, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>-->
                        <!--<TextBox Width="120" Name="ProjektID"/>-->
                        <!--<TextBox Width="120"  Name="Projektnummer" Text="070784" SnapsToDevicePixels="True" />-->
                        <!--<Button Content="Projekt by ID" Margin="3" Height="23" Name="ProjectByID" Width="60" Click="ProjectByID_Click" />-->
                        <!--<Button Content="Projekt by Nr." Margin="3" Height="23" Name="ProjectByNumber" Width="60" Click="ProjectByNumber_Click" Background="#FF0C0D0B" Foreground="#FF31F510"></Button>-->
                    </StackPanel>
                    <StackPanel Name="SP4" Grid.Row="4" Orientation="Horizontal" Background="#FFE1EEF0">
                        <Label Content="Anfrage:" Style="{StaticResource LabelStaticData}"/>
                        <Label Content="Auftrag:" Style="{StaticResource LabelStaticData}"/>
                        <Label  Content="SI:" Style="{StaticResource LabelStaticData}"/>
                        <Label Name="lblLand" Content="Land:" Style="{StaticResource LabelStaticData}"/>
                        <Label Name="lblSchiff" Content="Schiff:" Style="{StaticResource LabelStaticData}"/>
                        <Label Name="lblUmsatzsteuer" Content="Umsatzsteuerbefreit :" Style="{StaticResource LabelStaticData}"/>
                    </StackPanel>
                    <StackPanel Name="SP5" Grid.Row="5" Orientation="Horizontal" >
                        <TextBox x:Name="txtUrsprungsprojekt" Style="{StaticResource TextboxStaticData}" Text="{Binding Path=ursprungsprojekt,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Margin="10,3,3,3" MaxLength="32" />
                        <TextBox  x:Name="txtWerftname" Style="{StaticResource TextboxStaticData}" Text="{Binding Path=werftname,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" MaxLength="64" IsReadOnly="False" />
                        <TextBox x:Name="txtWerfnummer" Style="{StaticResource TextboxStaticData}" Text="{Binding Path=werftnummer,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" MaxLength="32" />
                        <TextBox x:Name="txtInterneNummer" Style="{StaticResource TextboxStaticData}" Text="{Binding Path=internnumber}" MaxLength="32" />
                        <ComboBox Height="23" HorizontalAlignment="Left" Name="cboUrsprung" VerticalAlignment="Center" Margin="3" Width="150"
                                      IsSynchronizedWithCurrentItem="False" 
                                     ItemsSource="{Binding Source={StaticResource UrsprungLookUp}}" 
                                    >
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock MinWidth="80">
                                            <Hyperlink Click="hylReklamationenUrsprung_Click" CommandParameter="{Binding Path=id}">
                                        <TextBlock Text="{Binding Path=projektnummer}"/>
                                            </Hyperlink>
                                        </TextBlock>
                                        <!--<TextBlock Text="     " />-->
                                        <TextBlock Text="{Binding Path=type}" MinWidth="100"/>
                                        <!--<TextBlock Text="     "/>-->
                                        <TextBlock Text="{Binding Path=datum,StringFormat=d}" MinWidth="120" Foreground="DarkGray"/>
                                        <TextBlock Text="{Binding Path=referenzkdbestellnummer}" Foreground="DarkGray"/>
                                        <!--<TextBlock Text=" - "/>
                                        <TextBlock>
                                            <Hyperlink x:Name="HylUrsprung" Click="hylReklamationenUrsprung_Click" CommandParameter="{Binding Path=id}" >Öffnen</Hyperlink>
                                        </TextBlock>-->
                                    </StackPanel>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                        <ComboBox x:Name="cboSprache" ItemsSource="{Binding Source={StaticResource SpracheLookUp}}" Margin="10,3,3,3" Width="120" Height="23"
                     DisplayMemberPath="Eintrag"
                     SelectedValue ="{Binding Path=id_Sprache,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                     SelectedValuePath="ai_int" IsSynchronizedWithCurrentItem="False"/>
                        <!--<ComboBox x:Name="cboReklamationen" Height="23" Width="120"
                            IsSynchronizedWithCurrentItem="False"
                                     ItemsSource="{Binding Source={StaticResource ReklamationLookUp}}" 
                                   >
                            <ComboBox.ItemTemplate>

                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="{Binding Path=projektnummer}"/>
                                        <TextBlock Text=" : " />
                                        <TextBlock Text="{Binding Path=referenzkdbestellnummer}"/>
                                        <TextBlock Text="  "/>
                                        <TextBlock>
                                            <Hyperlink x:Name="hylReklamationenUrsprung" Click="hylReklamationenUrsprung_Click" CommandParameter="{Binding Path=id}" >Öffnen</Hyperlink>
                                        </TextBlock>
                                    </StackPanel>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>-->
                    </StackPanel>
                    <StackPanel Name="SP6" Grid.Row="6">
                        <StackPanel Grid.Row="6" Orientation="Horizontal" >
                            <!--<Label Content="Ursprungsprojekt:" Style="{StaticResource LabelStaticData}" Margin="10,-5,0,0"/>-->
                            <TextBlock Margin="25,0,0,0" Width="110">
                                <Hyperlink x:Name="hylUrsprungsprojekt" Click="hylUrsprungsprojekt_Click">
                                    <TextBlock FontSize="12" Text="Ursprungsprojekt" />
                                </Hyperlink>
                            </TextBlock>
                            <Label x:Name="lblWerft" Content="Werft:" Style="{StaticResource LabelStaticData}"/>
                            <Label x:Name="lblNBNr"  Content ="NB-Nr." Style="{StaticResource LabelStaticData}"/>
                            <Label x:Name="lblInterneNummer" Content="Int no.:" Style="{StaticResource LabelStaticData}"/>
                            <Label Content="untergeordnete Projekte:" Style="{StaticResource LabelStaticData}" Width="146" />
                            <Label Content="Sprache" Style="{StaticResource LabelStaticData}"/>

                        </StackPanel>
                        <!--<StackPanel Orientation="Horizontal">
                            <TextBlock Margin="15,0,0,0">
                                <Hyperlink x:Name="hylUrsprungsprojekt" Click="hylUrsprungsprojekt_Click"> Ursprungsprojekt</Hyperlink>
                            </TextBlock>
                        </StackPanel>-->
                    </StackPanel>
                    <StackPanel Grid.Row="7" Orientation="Horizontal" Height="Auto" VerticalAlignment="Stretch" Width="Auto" HorizontalAlignment="Left">
                        <!--<TextBox Name="txtKunde" Text="{Binding Path=kundenname}" Width="90"/>-->
                        <!--<c1:C1ComboBox Name="cboTestKunde" 
                            HorizontalAlignment="Left" 
                            Margin="2" 
                            ItemsSource="{Binding Source={StaticResource KundenLookup}}" 
                            VerticalAlignment="Top" 
                            Width="163" 
                            Text="{Binding Path=name}" 
                            DisplayMemberPath="name" 
                            SelectedValuePath="kundenname" 
                            EditCompleted="cboTestKunde_EditCompleted"
                            IsTextSearchEnabled="True" 
  
                            IsEditable="True" IsManipulationEnabled="True">
                        </c1:C1ComboBox>-->
                        <!--<c1:C1ComboBox Height="23" HorizontalAlignment="Left" Name="cboKunde" VerticalAlignment="Center" Margin="10,3,3,3" Width="245"
                                    ItemsSource="{Binding Source={StaticResource KundenLookup}}" 
                                    SelectedValue ="{Binding Path= KdNr,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                   
                                    SelectedValuePath="KdNr"
                                    DisplayMemberPath="name" IsEditable="True" IsEnabled="True" IsManipulationEnabled="True"  IsTextSearchEnabled="True" EditCompleted="cboKunde_EditCompleted" IsDropDownOpen="False" PreviewKeyDown="cboKunde_PreviewKeyDown" GotFocus="cboKunde_GotFocus" Visibility="Visible" />-->
                        <!--<ComboBox Height="23" HorizontalAlignment="Left" Name="cboSchiff" VerticalAlignment="Center" Margin="10,3,3,3" Width="239"
                                      IsSynchronizedWithCurrentItem="False"
                                     ItemsSource="{Binding Source={StaticResource SchiffLookup}}" 
                                      SelectedValue ="{Binding Path=projekt_schiff,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                      SelectedValuePath="name"
                                      DisplayMemberPath="name" Visibility="Visible" />-->
                        <StackPanel>
                            <TextBlock Text="{Binding Path=KdNr}" Width="50" HorizontalAlignment="Left" Foreground="DarkGray" FontSize="14" Margin="15,0,0,0"/>
                            <controls:FilteredComboBox  x:Name="fcbKunde" ControlsWidth="245"  Width="245" Margin="10,3,3,3" Height="23" onfcbChanged="fcbKunde_onfcbChanged" MaxTextLength="128" Visibility="Visible" OnFcb_SelectionChanged="fcbKunde_OnFcb_SelectionChanged" VerticalAlignment="Stretch" />
                        </StackPanel>
                        <StackPanel>
                            <!--<TextBlock Visibility="Hidden"  Width="50" HorizontalAlignment="Left" Foreground="DarkGray" FontSize="14" Margin="15,0,0,0" />-->
                            <!--<uc:FilteredComboBox_Extended x:Name="fcbLieferadresse" CBoxItemssource="{Binding Source= {StaticResource LieferadressenLookUp}}" IsEnabled="{Binding Path=isEnabled}"
                                                        cBoxItemTemplate="{StaticResource AdressenTemplate}"
                                                        StoredItemTemplate="{StaticResource AdressenTemplate}"
                                                        CBoxSelectedValue="{Binding Path=id_Lieferadresse,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                        CBoxSelectedValuePath="id"
                                                        onfcbChanged="fcbLieferadresse_onfcbChanged"
                                                        DisplayedMemberpath="Postfach"/>-->
                        </StackPanel>
                        <StackPanel>
                            <TextBlock Text="-" />
                            <controls:FilteredTextBox  x:Name="ftbSchiff" ControlsWidth="245" onfcbChanged="fcbSchiff_onfcbChanged" Width="245" Margin="3,7,0,0" Height="23" MaxTextLength="64" VerticalAlignment="Stretch" />
                        </StackPanel>
                        <StackPanel>
                            <CheckBox IsChecked="{Binding Path= istUmsatzsteuerbefreit}" Style="{StaticResource CheckboxStaticData}" Margin="17,20,0,0"/>
                        </StackPanel>
                        <!--<Button  x:Name="TestData" Click="TestData_Click" Width="60"/>-->
                        <!--<TextBox x:Name="txtSchiff" Style="{StaticResource TextboxStaticData}" Text="{Binding Path= projekt_schiff,Mode=TwoWay}"/>-->
                        <TextBox Name="txtID" Style="{StaticResource TextboxStaticData}" Text="{Binding Path=id, Mode=OneWay}" Visibility="Hidden" />
                        <!--<TextBox Style="{StaticResource TextboxStaticData}" Text="{Binding Path=kundenname, Mode=OneWay}"/>-->
                        <!--<local:AutoCompleteTextBox Height="23" Width="240" Text="{Binding firmenname}" x:Name="AutoBox1" DelayTime="100" Threshold="2"/>-->
                        <!--<c1:C1ComboBox IsEditable="True" Width="120" AutoComplete="True" ItemsSource="{Binding Source={StaticResource KundenLookup}}"
                                        SelectedValue ="{Binding Path=kundenname,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                     SelectedValuePath="name"
                                      DisplayMemberPath="name"/>-->
                    </StackPanel>
                    <StackPanel Grid.Row="8" Orientation="Horizontal" >
                        <Label Content="Kundenname:" Style="{StaticResource LabelStaticData}" Margin="10,-5,0,0" Width="243" />
                        <!--<Label  Content="Lieferadresse" Style="{StaticResource LabelStaticData}" Width="250" />-->
                        <Label x:Name="lblSchiffProjekt" Content="Schiff/ Projekt :" Style="{StaticResource LabelStaticData}" Margin="10,-5,0,0" Width="243" />
                        <Label Content="Umsatzsteuerbefreit :" Style="{StaticResource LabelStaticData}" Margin="10,-5,0,0"/>
                        <TextBlock Name="tblSchiffUebernehmen"  Margin="0,5,0,0">
                            <Hyperlink Name="hylSchiffuebernehmen" Click="hylSchiffuebernehmen_Click" FontSize="13">Daten übernehmen</Hyperlink></TextBlock>
                        <!--<Label Content="Projekt ID :" Style="{StaticResource LabelStaticData}"/>-->
                        <!--<Label Content="Kundenname Temporär :" Style="{StaticResource LabelStaticData}"/>-->
                    </StackPanel>
                    <StackPanel Name="SP9" Grid.Row="9" Orientation="Horizontal" Height="30" VerticalAlignment="Top" Background="#FFD1DCE8">
                        <TextBox x:Name="imonummer" Style="{StaticResource TextboxStaticData}" Text="{Binding Path=imonummer,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Margin="10,3,0,3" />
                        <TextBox Style="{StaticResource TextboxStaticData}" Text="{Binding Path=referenzkdbestellnummer}" Margin="10,0,0,0" Width="362" MaxLength="64" />
                    </StackPanel>
                    <StackPanel Name="SP10" Grid.Row="10" Orientation="Horizontal" >
                        <Label x:Name="lblImoNummer" Content="IMO-Nr.:" Style="{StaticResource LabelStaticData}" Margin="10,-5,0,0"/>
                        <Label Content="Referenz(Kd.) / Best.-Nr:" Style="{StaticResource LabelStaticData}" Width="129" />
                    </StackPanel>
                    <StackPanel Name="SP11"  Grid.Row="11" Orientation="Horizontal">
                        <TextBox x:Name="txtAngebot" Style="{StaticResource TextboxStaticData}" Height="Auto" Width="650" Text="{Binding Path=angebotauftrag}" AcceptsReturn="True" Margin="10,3,3,3" Visibility="Visible" />
                    </StackPanel>
                    <StackPanel Name="SP12"  Grid.Row="12" Orientation="Horizontal" >

                        <Label x:Name="LblAngebot" Content="Angebot:" Style="{StaticResource LabelStaticData}" Visibility="Visible" />
                    </StackPanel>

                    <StackPanel Grid.Row="13">

                    </StackPanel>
                    <!--<TextBox Grid.Row="7" Height="23" HorizontalAlignment="Left" Margin="666,19,0,0" Name="textBox1" VerticalAlignment="Top" Width="120"
                             Text="{Binding Path=firmenname}"/>-->
                    <!--Aggregate-->
                </Grid>
                <StackPanel Margin="20,0,0,0">
                    <ListView   ItemsSource="{Binding Source= {StaticResource Aggregate_ViewSource}}" Name="Aggregate_ListView"  SelectionMode="Single"
                               DataContext="{Binding}">
                        <ListView.ItemContainerStyle>
                            <Style TargetType="ListViewItem">
                                <EventSetter Event="GotFocus" Handler="Aggregate_ListView_GotFocus" />
                            </Style>
                        </ListView.ItemContainerStyle>
                        <ListView.View>
                            <GridView x:Name="DataGrid_Aggregate"  >
                                <GridViewColumn  Header="Anlage" Width="150">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <ComboBox Height="23" HorizontalAlignment="Left" IsEditable="True" Name="cboFirma" VerticalAlignment="Center" Margin="3" Width="140"
                                      IsSynchronizedWithCurrentItem="False"
                                      ItemsSource="{Binding Source={StaticResource AggregateLookup}}" 
                                      SelectedValue ="{Binding Path=id_aggregat,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                      SelectedValuePath="id"
                                      DisplayMemberPath="aggregat"/>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn  Header="Kennzeichen" Width="90">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBox Margin="3,0" Width="90" Text="{Binding Path=Kennzeichen, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn   Header="Bemerkung" Width="90">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBox Margin="3,0" Width="90" Text="{Binding Path=Bemerkung, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"  />
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                                <GridViewColumn x:Name="cmdDeleteAggregate" Header="Delete" Width="60">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <Button Name="cmdDeleteAggregate" Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                <Image Source="{StaticResource BitmapDelete}"/>
                                            </Button>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>
                    </ListView>
                    <Button Name="AddAggregate" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14" Click="AddAggregate_Click">
                        <Image Source="{StaticResource BitmapPlus}" />
                    </Button>
                </StackPanel>
            </StackPanel>
            <StackPanel Grid.Row="1" >
                <StackPanel Orientation="Horizontal" >
                    <CheckBox Name="chkExpandProject" Content="Projekt ausklappen" Click="chkExpandProject_Click" Margin="10,3,3,3"/>
                </StackPanel>
                <Expander x:Name="EXLieferadresse" Header="Lieferadresse" Grid.Row="13" Margin="10,5,0,0">

                    <ContentControl x:Name="CCLieferadresse">
                        <ctv:AdressenView DataContext="{Binding}"/>
                    </ContentControl>
                </Expander>
                <!--Gridscrolldata-->
                <Grid Name="GridSrcollData" >
                    <Grid.RowDefinitions>
                        <RowDefinition Name="rdAnlagenTyp" Height="Auto"/>
                        <RowDefinition Name="rdProjektVerlauf" Height="Auto"/>
                        <RowDefinition Name="rdRechnungen" Height="Auto"/>
                        <RowDefinition Height="150"/>
                        <RowDefinition Height="150"/>
                    </Grid.RowDefinitions>
                    <StackPanel Name ="SPScrollData" Grid.Row="0" Height="Auto">
                        <Expander Name="ExpAnlagenTyp" Header="AnlagenTyp" Margin="10,0,0,0">
                            <StackPanel Name="StackAnlagenTyp" Height="Auto">
                                <ListView  ItemsSource="{Binding Source= {StaticResource AnlagenTyp_ViewSource}}" Name="AnlagenTyp_ListView"  SelectionMode="Single"
                               DataContext="{Binding}">
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                            <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                            <EventSetter Event="GotFocus" Handler="AnlagenTyp_ListView_GotFocus" />
                                        </Style>
                                    </ListView.ItemContainerStyle>
                                    <ListView.View >
                                        <GridView x:Name="DataGrid_AnlagenTyp" >
                                            <GridViewColumn x:Name="AnlagenTyp"  Header="AnlagenTyp" Width="Auto">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBox Margin="6,-1,-6,-1" MinWidth="340" Text="{Binding Path=type, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" AcceptsReturn="True" />
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn x:Name="Anzahl" Header="Anzahl" Width="80">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBox Margin="-6,-1" Text="{Binding Path=anzahl, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn x:Name="AngebotErstellt" Header="Angebot erstellt" Width="Auto">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <DatePicker Margin="0" SelectedDate="{Binding Path=angeboterstellt, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn x:Name="AngebotWeitergeleitet" Header="Angebot weitergeleitet" Width="Auto">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <DatePicker Margin="-6,-1" SelectedDate="{Binding Path=angebotweitergeleitet, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn x:Name="Lieferzeit" Header="Lieferzeit" Width="150">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBox Text="{Binding Path=lieferzeit,Mode=TwoWay}"></TextBox>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn x:Name="Preis" Header="Preis" Width="150">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBox Text="{Binding Path=preis,Mode=TwoWay,StringFormat=n}"></TextBox>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn x:Name="WKZ" Header="WKZ" Width="70">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <ComboBox ItemsSource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                   SelectedValue="{Binding Path=id_WKZ,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                                   SelectedValuePath="id"
                                                                   DisplayMemberPath="WKZ" Background="White" 
                                                                  Width="60" Margin="-5,0,0,0"
                                                                  IsSynchronizedWithCurrentItem="False"/>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            
                                            <GridViewColumn x:Name="Kommentar" Header="Kommentar" Width="150">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBox Text="{Binding Path=kommentar,Mode=TwoWay}"></TextBox>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn x:Name="cmdDeleteTyp" Header="" Width="40">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Button Name="cmdDeleteTyp" Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                            <Image Source="{StaticResource BitmapDelete}"/>
                                                        </Button>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                        </GridView>
                                    </ListView.View>
                                </ListView>
                                <Button Name="AddAnlagenTyp" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14" Click="AddAnlagenTyp_Click">
                                    <Image Source="{StaticResource BitmapPlus}" />
                                </Button>
                            </StackPanel>
                        </Expander>
                        <Expander Name="expKalkulationstabellen" Header="Kalkulationstabellen" MinHeight="25"  Height="Auto" Margin="10,0,0,0">
                            <StackPanel>
                                <ListView Name="KalkulationListView" Margin="10,5,5,0" Width="Auto" Height="Auto" ItemsSource="{Binding Source= {StaticResource KalkulationLookUp}}" DataContext="{Binding}">
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <EventSetter Event="GotFocus" Handler="KalkulationListView_GotFocus" />
                                        </Style>
                                    </ListView.ItemContainerStyle>
                                    <ListView.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <!--<TextBlock Text="{Binding Path=inhalt}"/>
                                                <TextBlock Text="{Binding Path=id}"/>-->
                                                <TextBlock Margin="0,5,0,0" Width="300">
                                                 <Hyperlink Name="hylKalkulation" Click="hylKalkulation_Click" CommandParameter="{Binding Path=id}">
                                                     <StackPanel Orientation="Horizontal">
                                                        <TextBlock Text="{Binding Path=id,Converter= {StaticResource CountIndexConverter1}}"></TextBlock>
                                                        <TextBlock Text=". Inhalt : "></TextBlock>   
                                                        <TextBlock Text="{Binding Path=inhalt}"></TextBlock>
                                                        <TextBlock Text=" [ID] "></TextBlock> 
                                                        <TextBlock Text="{Binding Path=id}"></TextBlock>
                                                         
                                                     </StackPanel>
                                                 </Hyperlink>
                                                </TextBlock>
                                                <Button Name="cmdDeleteCalcDetail" Click="Delete_ListViewItem_Click" CommandParameter="{Binding Path=id}" Margin="50,0,0,0" HorizontalAlignment="Center" Style="{StaticResource StyleSymbol}">
                                                    <Image Source="{StaticResource BitmapDelete}" />
                                                </Button>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ListView.ItemTemplate>
                                </ListView>
                                <Button Name="AddKalkulation" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14" Click="btnAddCalculation_Click">
                                    <Image Source="{StaticResource BitmapPlus}" />
                                </Button>
                            </StackPanel>
                        </Expander>
                        <!--</StackPanel>-->
                        <!--</Expander>-->
                        <Expander Name="ExpProjektverlauf" Header="Projektverlauf" Margin="10,0,0,0">
                            <StackPanel Name="StackProjektVerlauf" Height="Auto" HorizontalAlignment="Stretch">
                                <ListView  ItemsSource="{Binding Source= {StaticResource ProjektVerlauf_ViewSource}}" Name="projekt_verlaufListView"  SelectionMode="Single"
                               DataContext="{Binding}">
                                    <ListView.ItemContainerStyle>
                                        <Style TargetType="ListViewItem">
                                            <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                            <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                            <EventSetter Event="GotFocus" Handler="projekt_verlaufListView_GotFocus"/>
                                        </Style>
                                    </ListView.ItemContainerStyle>
                                    <ListView.View >
                                        <GridView x:Name="DataGrid_Verlauf" >
                                            <GridViewColumn x:Name="idColumn" Header="Pos." Width="40">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBox Margin="-6,-1" Text="{Binding Path=idx, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,Converter= {StaticResource CountIndexConverter}}" />
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn x:Name="bemerkungColumn"  Header="Bemerkung" Width="Auto">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBox Margin="6,-1,-6,-1" MinWidth="800" Text="{Binding Path=bemerkung, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" AcceptsReturn="True" Height="Auto" />
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn x:Name="id_personchangeColumn" Header="letzte Aenderung" Width="120">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <TextBox Text="{Binding Path=id_personchange,Mode=OneWay,Converter={StaticResource personconverter}}"></TextBox>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn x:Name="idMarker" Header="Anzeige" Width="60">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <Image Source="/ProjektDB;component/Images/tippNeu20.png" Margin="5,0,5,0"></Image>
                                                            <CheckBox Margin="0,5,0,0" IsChecked ="{Binding Path=marker, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn x:Name="datumColumn" Header="Datum" Width="150">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <DatePicker Margin="-6,-1" SelectedDate="{Binding Path=datum, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn x:Name="idHassend" Header="Gesendet" Width="60">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal">
                                                            <CheckBox Margin="0,5,0,0" IsChecked ="{Binding Path=hassend, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                            <GridViewColumn x:Name="cmdDelete" Header="" Width="40">
                                                <GridViewColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Button Name="cmdDeleteVerlauf"   Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                            <Image Source="Images\del.png"></Image>
                                                        </Button>
                                                    </DataTemplate>
                                                </GridViewColumn.CellTemplate>
                                            </GridViewColumn>
                                        </GridView>
                                    </ListView.View>
                                </ListView>
                                <Button Name="AddProjektVerlauf" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14" Click="AddProjektVerlauf_Click">
                                    <Image Source="{StaticResource BitmapPlus}" />
                                </Button>
                            </StackPanel>
                        </Expander>
                        <Border Name="brdKalkulation" Margin="10,0,0,3" BorderThickness="1" CornerRadius="10" BorderBrush="Black"></Border>
                        <!-- Lagerlisten -->
                        <Border Name="brdLagerlisten" Margin="10,0,0,3" BorderThickness="1" CornerRadius="10" BorderBrush="Black">
                            <Expander Name="expLagerlisten" Header="Lagerlisten" Height="Auto">
                                <StackPanel>
                                    <ListBox Name="lbLagerlisten" Margin="10,5,5,0" Width="Auto" Height="Auto" ItemsSource="{Binding Source= {StaticResource LagerlistenLookUp}}" DataContext="{Binding}" >
                                        <ListBox.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" >
                                                    <!--<TextBlock Text="{Binding Path=inhalt}"/>
                                                <TextBlock Text="{Binding Path=id}"/>-->
                                                    <TextBlock Margin="0,5,0,0" Width="500">
                                                 <Hyperlink Name="hylLagerlisten" Click="hylLagerlisten_Click" CommandParameter="{Binding Path=id}"  >
                                                     <StackPanel Orientation="Horizontal" >
                                                        <TextBlock Text="{Binding Path=id,Converter= {StaticResource CountIndexConverter2}}"></TextBlock>
                                                        <TextBlock Text=". Bezeichnung : "></TextBlock>   
                                                        <TextBlock Text="{Binding Path=bezeichnung}"></TextBlock>
                                                        <TextBlock Text=" Artikel Nr : "></TextBlock>   
                                                        <TextBlock Text="{Binding Path=artikelnr}"></TextBlock>
                                                        <TextBlock Text=" Anzahl : "></TextBlock>   
                                                        <TextBlock>
                                                                    <TextBlock.Text>
                                                                        <MultiBinding Converter="{StaticResource MultiBindConverter}">
                                                                            <Binding Path="addtype"/>
                                                                            <Binding Path="anzahl"/>
                                                                        </MultiBinding>
                                                                    </TextBlock.Text>
                                                        </TextBlock>
                                                        <TextBlock Text=" Datum : "></TextBlock> 
                                                        <TextBlock Text="{Binding Path=created,StringFormat=d}"></TextBlock>
                                                         
                                                     </StackPanel>
                                                 </Hyperlink>
                                                </TextBlock>
                                                    <!--<Button Name="cmdDeleteLagerlisten"  Margin="50,0,0,0" HorizontalAlignment="Center" Style="{StaticResource StyleSymbol}">
                                                        <Image Source="{StaticResource BitmapDelete}"/>
                                                    </Button>-->
                                                </StackPanel>
                                            </DataTemplate>
                                        </ListBox.ItemTemplate>
                                    </ListBox>
                                    <Button Name="AddArtikel" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14" Click="AddArtikel_Click">
                                        <Image Source="{StaticResource BitmapPlus}" />
                                    </Button>
                                </StackPanel>
                            </Expander>
                        </Border>
                        <!--Rechnungen Anfragen-->
                        <Border Name="brdRechnungenAnfragen" Margin="10,0,0,3" BorderThickness="2" CornerRadius="10" BorderBrush="LawnGreen" >
                            <Expander Name="exp_AnfragenRechnungen" Header="Rechnungen im Vorauftragstatus">
                                <StackPanel>
                                    <StackPanel.Resources>
                                        <Style TargetType="TextBox"  >
                                            <Setter Property="Height" Value="24" />
                                            <Setter Property="FontFamily" Value="Calibri" />
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Margin" Value="3"/>
                                            <Setter Property="Width" Value="150" />
                                        </Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="FontSize" Value="12" />
                                            <Setter Property="FontFamily" Value="Calibri" />
                                            <Setter Property="Width" Value="110" />
                                            <Setter Property="Margin" Value="2,5" />
                                            <Setter Property="TextAlignment" Value="Left"/>
                                        </Style>
                                        <Style TargetType="DatePicker">
                                            <Setter Property="Height" Value="24" />
                                            <Setter Property="Width" Value="150" />
                                            <Setter Property="Margin" Value="3" />
                                        </Style>
                                        <Style TargetType="CheckBox">
                                            <Setter Property="Margin" Value="0"/>
                                        </Style>
                                    </StackPanel.Resources>
                                    <Rectangle  Margin="0,10,0,0"  ></Rectangle>
                                    <Expander Name="Exp_ProjektRechnungKunde" Header="Rechnungen Kunden" Margin="10,0,0,0">
                                        <StackPanel Name="Stack_ProjektRechnungKunde"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource Projekt_RechnungenKunde}}" Name="ProjektRechnungKunde_ListView"  SelectionMode="Single"
                                                        DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="ProjektRechnungKunde_GotFocus"/>
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_ProjektRechnungKunde" >
                                                        <GridViewColumn   Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel>
                                                                        <StackPanel>
                                                                            <StackPanel Height="Auto" Orientation="Horizontal">
                                                                                <StackPanel>
                                                                                    <controls:LabelAndText TextBlockText="Kundenname :" TextBoxText="{Binding Path=kundenname, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                                                                                    <controls:LabelAndDatepicker TextBlockText="Rechnungsdatum :" DatePickerDateTime="{Binding Path=rechnungsdatum, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <StackPanel Orientation="Horizontal">
                                                                                        <controls:LabelAndText TextBlockText="Rechnungs Nr. :" TextBoxText="{Binding Path=rechnungsnummer, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                                                                                        <!--<Button Content="..." Name="btnCallAusgangsRechnung" Click="btnCallAusgangsRechnung_Click" Margin="10,30,10,0" Style="{StaticResource StyleSymbol}" IsEnabled="True" Visibility="Visible" ToolTip="Rechnung in Word öffnen" />-->
                                                                                    </StackPanel>
                                                                                    <controls:LabelAndDatepicker TextBlockText="Rechnung fällig :" DatePickerDateTime="{Binding Path=rechnungfaellig, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:BetragWaehrung TextBoxText="{Binding Path=rechnungsbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Rechnungsbetrag :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                         CBoxSelectedValue="{Binding Path=wkz,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                                                                    <controls:LabelAndCurrency TextBlockText="gezahlter Betrag :" TextBoxText="{Binding Path=rechnungseingang, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}'}"/>
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:LabelAndCurrency TextBlockText="MWST Betrag :" TextBoxText="{Binding Path=mwstbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}'}"/>
                                                                                    <controls:LabelAndDatepicker TextBlockText="Rechnung bezahlt :" DatePickerDateTime="{Binding Path=rechnungbezahlt, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                                                                    <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                      IsSynchronizedWithCurrentItem="False"
                                                                                      ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                      SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                      SelectedValuePath="id"
                                                                                      ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                                                                                </StackPanel>
                                                                                <Button Name="cmdDeleteProjektRechnungKunde"   Click="Delete_ListViewItem_Click"  Style="{StaticResource StyleSymbol}">
                                                                                    <Image Source="Images\del.png"></Image>
                                                                                </Button>
                                                                            </StackPanel>
                                                                        </StackPanel>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="Add_ProjektRechnungKunde" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14" Click="cmd_AddListViewItem_Click"  >
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                    <Expander Name="Exp_ProjektGutschriftKunde" Header="Gutschriften Kunden" Margin="10,0,0,0">
                                        <StackPanel Name="Stack_ProjektGutschriftKunde"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource Projekt_GutschriftenKunde}}" Name="ProjektGutschriftKunde_ListView"  SelectionMode="Single"
                                                        DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="ProjektGutschriftKunde_GotFocus" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_ProjektGutschriftKunde" >
                                                        <GridViewColumn   Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel>
                                                                        <StackPanel>
                                                                            <StackPanel Height="Auto" Orientation="Horizontal">
                                                                                <controls:LabelAndText TextBlockText="Kundenname" TextBoxText="{Binding Path=kundenname, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                                                                                <controls:LabelAndText TextBlockText="Gutschrift Nr. :" TextBoxText="{Binding Path=gutschriftnummer, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                                                                <controls:LabelAndDatepicker TextBlockText="Gutschriftdatum :" DatePickerDateTime="{Binding Path=gutschriftdatum, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                <controls:BetragWaehrung TextBoxText="{Binding Path=gutschriftbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Gutschriftbetrag :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                         CBoxSelectedValue="{Binding Path=wkz,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                                                                <controls:LabelAndCurrency TextBlockText="MWST Betrag :" TextBoxText="{Binding Path=mwstbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat='c'}"/>
                                                                                <controls:LabelAndDatepicker TextBlockText="Gutschrift beglichen :" DatePickerDateTime="{Binding Path=gutschriftbeglichen, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                                <StackPanel>
                                                                                    <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                                                                    <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                      IsSynchronizedWithCurrentItem="False"
                                                                                      ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                      SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                      SelectedValuePath="id"
                                                                                      ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                                                                                </StackPanel>
                                                                                <Button Name="cmdDeleteProjektGutschriftKunde"   Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                                                    <Image Source="Images\del.png"></Image>
                                                                                </Button>
                                                                            </StackPanel>
                                                                        </StackPanel>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="Add_ProjektGutschriftKunde" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14"  Click="cmd_AddListViewItem_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                    <Expander Name="Exp_ProjektRechnungLieferant" Header="Rechnungen Lieferanten" Margin="10,0,0,0">
                                        <StackPanel Name="StackProjektRechnungLieferant"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource Projekt_RechnungenLieferant}}" Name="ProjektRechnungLieferant_ListView"  SelectionMode="Single"
                                                        DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="ProjektRechnungLieferant_GotFocus" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_ProjektRechnungLieferant"  >
                                                        <GridViewColumn Header="" Width="Auto" CellTemplate="{StaticResource ProjektRechnungenLieferantTemplate}">
                                                            <!--<GridViewColumn.CellTemplate>
                                                           
                                                        </GridViewColumn.CellTemplate>-->
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="Add_ProjektRechnungLieferant" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14"  Click="cmd_AddListViewItem_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                    <Expander Name="Exp_ProjektGutschriftLieferant" Header="Gutschriften Liferanten" Margin="10,0,0,0">
                                        <StackPanel Name="StackProjektGutschriftLieferant"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource Projekt_GutschriftenLieferant}}" Name="ProjektGutschriftLieferant_ListView"  SelectionMode="Single"
                                                        DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="ProjektGutschriftLieferant_GotFocus" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_ProjektGutschriftLieferant" >
                                                        <GridViewColumn   Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel>
                                                                        <StackPanel>
                                                                            <StackPanel Height="Auto" Orientation="Horizontal">
                                                                                <controls:LabelAndText TextBlockText="Lieferant Name :" TextBoxText="{Binding Path=lieferantname, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                                                                                <controls:LabelAndText TextBlockText="Gutschrift Nr. :" TextBoxText="{Binding Path=gutschriftnummer, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                                                                <controls:LabelAndDatepicker TextBlockText="Gutschrift Datum :" DatePickerDateTime="{Binding Path=gutschriftdatum, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                <controls:BetragWaehrung TextBoxText="{Binding Path=gutschriftbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Gutschriftbetrag :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                         CBoxSelectedValue="{Binding Path=wkz,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                                                                <controls:LabelAndCurrency TextBlockText="MWST Betrag :" TextBoxText="{Binding Path=mwstbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat='c'}"/>
                                                                                <controls:LabelAndDatepicker TextBlockText="Gutschrift erhalten :" DatePickerDateTime="{Binding Path=gutschrifterhalten, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                <StackPanel>
                                                                                    <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                                                                    <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                      IsSynchronizedWithCurrentItem="False"
                                                                                      ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                      SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                      SelectedValuePath="id"
                                                                                      ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                                                                                </StackPanel>
                                                                                <Button Name="cmdDeleteProjektGutschriftLieferant"   Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                                                    <Image Source="Images\del.png"></Image>
                                                                                </Button>
                                                                            </StackPanel>
                                                                        </StackPanel>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="Add_ProjektGutschriftLieferant" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14"  Click="cmd_AddListViewItem_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                </StackPanel>
                            </Expander>
                        </Border>
                        <!--Ende Rechnungen Anfragen-->
                        <!--Auftrag mit SI-->
                        <Border Name="brdSI" Margin="10,0,0,3" BorderThickness="2" CornerRadius="10" BorderBrush="#FF1E4EEB" >
                            <Expander Name="ExpSIAuftrag" Header="SI" Height="Auto" Expanded="ExpSIAuftrag_Expanded">
                                <StackPanel Name="SPSIAuftrag">
                                    <StackPanel.Resources>
                                        <Style TargetType="TextBox"  >
                                            <Setter Property="Height" Value="24" />
                                            <Setter Property="FontFamily" Value="Calibri" />
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Margin" Value="3"/>
                                            <Setter Property="Width" Value="150" />
                                        </Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="FontSize" Value="12" />
                                            <Setter Property="FontFamily" Value="Calibri" />
                                            <Setter Property="Width" Value="110" />
                                            <Setter Property="Margin" Value="2,5" />
                                            <Setter Property="TextAlignment" Value="Left"/>
                                        </Style>
                                        <Style TargetType="DatePicker">
                                            <Setter Property="Height" Value="24" />
                                            <Setter Property="Width" Value="150" />
                                            <Setter Property="Margin" Value="3" />
                                        </Style>
                                        <Style TargetType="CheckBox">
                                            <Setter Property="Margin" Value="0"/>
                                        </Style>
                                    </StackPanel.Resources>
                                    <StackPanel Name="SI_AuftragKopf" Height="Auto">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Auftrag erhalten " />
                                            <DatePicker SelectedDate="{Binding Path=ersatzteileauftragerhalten, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                            <TextBlock Text="Auftragsbest. " />
                                            <DatePicker SelectedDate="{Binding Path=ersatzteileauftragsbestaetigung, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                            <TextBlock Text="Lager " />
                                            <CheckBox IsChecked="{Binding Path=lager, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Ersatzteile bestellt" />
                                            <DatePicker SelectedDate="{Binding Path=ersatzteilebestellt, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                            <TextBlock Text="Ersatzteile erhalten" />
                                            <DatePicker SelectedDate="{Binding Path=ersatzteileerhalten, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                            <TextBlock Text="Ersatzteile an Kunden" />
                                            <DatePicker SelectedDate="{Binding Path=ersatzteileankunden, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                        </StackPanel>
                                    </StackPanel>
                                    <Expander Name="ExpSI_RgKunde" Header="Ausgangsrechnungen">
                                        <StackPanel Name="StackSI_RgKunde"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource SI_RgKunde_ViewSource}}" Name="SI_RgKunde_ListView"  SelectionMode="Single"
                                                        DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="SI_RgKunde_ListView_GotFocus"/>
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_SI_RgKunde" >
                                                        <GridViewColumn   Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel>
                                                                        <StackPanel>
                                                                            <StackPanel Height="Auto" Orientation="Horizontal">
                                                                                <StackPanel>
                                                                                    <controls:LabelAndText TextBlockText="Kundenname :" TextBoxText="{Binding Path=name, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                                                                                    <controls:LabelAndDatepicker TextBlockText="Rechnungsdatum :" DatePickerDateTime="{Binding Path=rechnungan, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <StackPanel Orientation="Horizontal">
                                                                                        <controls:LabelAndText TextBlockText="Rechnungs Nr. :" TextBoxText="{Binding Path=rechnungsnr, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                                                                                        <Button Content="..." Name="btnCallAusgangsRechnung" Click="btnCallAusgangsRechnung_Click" Margin="10,30,10,0" Style="{StaticResource StyleSymbol}" IsEnabled="True" Visibility="Visible" ToolTip="Rechnung in Word öffnen" />
                                                                                    </StackPanel>
                                                                                    <controls:LabelAndDatepicker TextBlockText="Rechnung fällig :" DatePickerDateTime="{Binding Path=rechnungfaellig, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:BetragWaehrung TextBoxText="{Binding Path=rechnungsbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Rechnungsbetrag :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                         CBoxSelectedValue="{Binding Path=wkz,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                                                                    <controls:LabelAndCurrency TextBlockText="gezahlter Betrag :" TextBoxText="{Binding Path=rechnungseingang, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}'}"/>
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:LabelAndCurrency TextBlockText="MWST Betrag :" TextBoxText="{Binding Path=mwstbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}'}"/>
                                                                                    <controls:LabelAndDatepicker TextBlockText="Rechnung bezahlt :" DatePickerDateTime="{Binding Path=rechnungvom, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                                                                    <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                      IsSynchronizedWithCurrentItem="False"
                                                                                      ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                      SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                      SelectedValuePath="id"
                                                                                      ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                                                                                </StackPanel>
                                                                                <Button Name="cmdDeleteSI_RgKunde"   Click="Delete_ListViewItem_Click"  Style="{StaticResource StyleSymbol}">
                                                                                    <Image Source="Images\del.png"></Image>
                                                                                </Button>
                                                                            </StackPanel>
                                                                        </StackPanel>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="AddSI_RgKunde" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14"  Click="AddSI_RgKunde_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                    <Expander Name="ExpSI_GSKunde" Header="Gutschriften an Kunden">
                                        <StackPanel Name="StackSI_GSKunde"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource SI_GSKunde_ViewSource}}" Name="SI_GSKunde_ListView"  SelectionMode="Single"
                                                        DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="SI_GSKunde_ListView_GotFocus" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_SI_GSKunde" >
                                                        <GridViewColumn   Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel>
                                                                        <StackPanel>
                                                                            <StackPanel Height="Auto" Orientation="Horizontal">
                                                                                <controls:LabelAndText TextBlockText="Kundenname" TextBoxText="{Binding Path=name, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                                                                                <controls:LabelAndText TextBlockText="Gutschrift Nr. :" TextBoxText="{Binding Path=nr, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                                                                <controls:LabelAndDatepicker TextBlockText="Gutschriftdatum :" DatePickerDateTime="{Binding Path=ankunden, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                <controls:BetragWaehrung TextBoxText="{Binding Path=gutschriftbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Gutschriftbetrag :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                         CBoxSelectedValue="{Binding Path=wkz,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                                                                <controls:LabelAndCurrency TextBlockText="MWST Betrag :" TextBoxText="{Binding Path=mwstbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat='c'}"/>
                                                                                <controls:LabelAndDatepicker TextBlockText="Gutschrift beglichen :" DatePickerDateTime="{Binding Path=erstellt, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                                <StackPanel>
                                                                                    <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                                                                    <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                      IsSynchronizedWithCurrentItem="False"
                                                                                      ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                      SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                      SelectedValuePath="id"
                                                                                      ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                                                                                </StackPanel>
                                                                                <Button Name="cmdDeleteSI_GSKunde"   Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                                                    <Image Source="Images\del.png"></Image>
                                                                                </Button>
                                                                            </StackPanel>
                                                                        </StackPanel>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="AddSI_GSKunde" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14"  Click="cmd_AddListViewItem_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                    <Expander Name="ExpSI_RGLieferant" Header="Lieferantenrechnungen">
                                        <StackPanel Name="StackSI_RGLieferant"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource SI_RgLieferant_ViewSource}}" Name="SI_RGLieferant_ListView"  SelectionMode="Single"
                                                        DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="SI_RGLieferant_ListView_GotFocus" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_SI_RGLieferant" >
                                                        <GridViewColumn Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate x:Name="TemplateTest">
                                                                    <StackPanel>
                                                                        <StackPanel>
                                                                            <StackPanel Height="Auto" Orientation="Horizontal">
                                                                                <StackPanel>
                                                                                    <controls:LabelAndText TextBlockText="Name :" TextBoxText="{Binding Path=lieferantname, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                    <controls:LabelAndDatepicker TextBlockText="Rechnungsdatum :" DatePickerDateTime="{Binding Path=rechnungsdatum, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:LabelAndText  TextBlockText="Rechnungsnummer :" TextBoxText="{Binding Path=lieferantnummer, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                    <controls:LabelAndDatepicker TextBlockText="Rechnung fällig :" DatePickerDateTime="{Binding Path=faellig, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:BetragWaehrung TextBoxText="{Binding Path=rechnungsbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Rechnungsbetrag :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                         CBoxSelectedValue="{Binding Path=wkz,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                                                                    <controls:LabelAndCurrency TextBlockText="gezahlter Betrag :" TextBoxText="{Binding Path=rechnungseingang, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:LabelAndCurrency TextBlockText="MWST. :" TextBoxText="{Binding Path=mwstbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                                                                                    <controls:LabelAndDatepicker TextBlockText="Rechnung bez. :" DatePickerDateTime="{Binding Path=lieferantbezahlt, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                </StackPanel>
                                                                                <Rectangle Width="10" Height="40" Stroke="Transparent" Fill="Transparent" Margin="15,0,15,0" />
                                                                                <StackPanel>
                                                                                    <controls:LabelAndCurrency TextBlockText="EUST Betrag :" TextBoxText="{Binding Path=eustbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                                                                                    <controls:LabelAndDatepicker TextBlockText="EUST :" DatePickerDateTime="{Binding Path=eust, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:LabelAndCurrency TextBlockText="Gebühren :" TextBoxText="{Binding Path=gebuehr, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                                                                                    <controls:LabelAndCurrency TextBlockText="MWST auf Gebühr :"
                                                                                                    TextBoxText="{Binding Path=mwstaufgebuehr, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}" />
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:LabelAndCurrency StackPanelOrientation="Vertical"  TextBlockText="Zollgebühren :" TextBoxText="{Binding Path= zollgebuehren,Mode=TwoWay,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                                                                                    <StackPanel>
                                                                                        <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                                                                        <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                         IsSynchronizedWithCurrentItem="False"
                                                                                          ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                          SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                          SelectedValuePath="id"
                                                                                          ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                                                                                    </StackPanel>
                                                                                </StackPanel>

                                                                                <Button Name="cmdDeleteSI_RgLieferant"   Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                                                    <Image Source="Images\del.png"></Image>
                                                                                </Button>
                                                                            </StackPanel>
                                                                        </StackPanel>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="AddSI_RGLieferant" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14"  Click="cmd_AddListViewItem_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                    <Expander Name="ExpSI_GSLieferant" Header="Gutschriften an Lieferanten">
                                        <StackPanel Name="StackSI_GSLieferant"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource SI_GSLieferant_ViewSource}}" Name="SI_GSLieferant_ListView"  SelectionMode="Single"
                                                        DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="SI_GSLieferant_ListView_GotFocus" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_SI_GSLieferant" >
                                                        <GridViewColumn   Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel>
                                                                        <StackPanel>
                                                                            <StackPanel Height="Auto" Orientation="Horizontal">
                                                                                <controls:LabelAndText TextBlockText="Lieferant Name :" TextBoxText="{Binding Path=name, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                                                                                <controls:LabelAndText TextBlockText="Gutschrift Nr. :" TextBoxText="{Binding Path=nr, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                                                                <controls:LabelAndDatepicker TextBlockText="Gutschrift Datum :" DatePickerDateTime="{Binding Path=gutschriftdatum, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                <controls:BetragWaehrung TextBoxText="{Binding Path=gutschriftbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Gutschriftbetrag :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                         CBoxSelectedValue="{Binding Path=wkz,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                                                                <controls:LabelAndCurrency TextBlockText="MWST Betrag :" TextBoxText="{Binding Path=mwstbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat='c'}"/>
                                                                                <controls:LabelAndDatepicker TextBlockText="Gutschrift erhalten :" DatePickerDateTime="{Binding Path=erhalten, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                <StackPanel>
                                                                                    <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                                                                    <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                      IsSynchronizedWithCurrentItem="False"
                                                                                      ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                      SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                      SelectedValuePath="id"
                                                                                      ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                                                                                </StackPanel>
                                                                                <Button Name="cmdDeleteSI_GSLieferant"   Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                                                    <Image Source="Images\del.png"></Image>
                                                                                </Button>
                                                                            </StackPanel>
                                                                        </StackPanel>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="AddSI_GSLieferant" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14"  Click="cmd_AddListViewItem_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                </StackPanel>
                            </Expander>
                        </Border>
                        <!--Auftrag ohne SI-->
                        <Border Name="brdAuftrag" Margin="10,0,0,0" BorderThickness="2" CornerRadius="10" BorderBrush="#FF3D2EEF">
                            <Expander Name="ExpAuftrag" Header ="Auftrag" Height="Auto">
                                <StackPanel Name="SPAuftrag">
                                    <StackPanel.Resources>
                                        <Style TargetType="TextBox"  >
                                            <Setter Property="Height" Value="24" />
                                            <Setter Property="FontFamily" Value="Calibri" />
                                            <Setter Property="FontSize" Value="14"/>
                                            <Setter Property="Margin" Value="3"/>
                                            <Setter Property="Width" Value="150" />
                                        </Style>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="FontSize" Value="12" />
                                            <Setter Property="FontFamily" Value="Calibri" />
                                            <Setter Property="Width" Value="90" />
                                            <Setter Property="Margin" Value="2,5" />
                                            <Setter Property="TextAlignment" Value="Right"/>
                                        </Style>
                                        <Style TargetType="DatePicker">
                                            <Setter Property="Height" Value="24" />
                                            <Setter Property="Width" Value="150" />
                                            <Setter Property="Margin" Value="3" />
                                        </Style>
                                        <Style TargetType="CheckBox">
                                            <Setter Property="Margin" Value="3"/>
                                        </Style>
                                    </StackPanel.Resources>
                                    <StackPanel Name="SPAuftrag_Kopf" >
                                        <StackPanel.Resources>
                                            <Style TargetType="TextBox"  >
                                                <Setter Property="Height" Value="24" />
                                                <Setter Property="FontFamily" Value="Calibri" />
                                                <Setter Property="FontSize" Value="14"/>
                                                <Setter Property="Margin" Value="3"/>
                                                <Setter Property="Width" Value="150" />
                                            </Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="FontSize" Value="13" />
                                                <Setter Property="FontFamily" Value="Calibri" />
                                                <Setter Property="Width" Value="150" />
                                                <Setter Property="Margin" Value="5" />
                                                <Setter Property="TextAlignment" Value="Right"/>
                                            </Style>
                                            <Style TargetType="DatePicker">
                                                <Setter Property="Height" Value="24" />
                                                <Setter Property="Width" Value="150" />
                                                <Setter Property="Margin" Value="3" />
                                            </Style>
                                            <Style TargetType="CheckBox">
                                                <Setter Property="Margin" Value="3"/>
                                            </Style>
                                        </StackPanel.Resources>
                                        <StackPanel x:Name="spAuftragKopf1Data" Orientation="Horizontal">
                                            <TextBox Text="{Binding Path=werftname}" />
                                            <TextBox Text="{Binding Path=werftnummer}" />
                                            <TextBox Text="{Binding Path=werftland}"  />
                                        </StackPanel>
                                        <StackPanel x:Name="spAuftragKopf1Label" Orientation="Horizontal">
                                            <TextBlock Text="Werft" TextAlignment="Center"></TextBlock>
                                            <TextBlock Text="NB-Nummer" TextAlignment="Center"></TextBlock>
                                            <TextBlock Text="Land" TextAlignment="Center"></TextBlock>
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <DatePicker Margin="3" SelectedDate="{Binding Path=auftragerhalten, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                            <DatePicker Margin="3" SelectedDate="{Binding Path=auftragsbestaetigung, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="Auftrag erhalten" TextAlignment="Center"></TextBlock>
                                            <TextBlock Text="Auftragsbestätigung" TextAlignment="Center"></TextBlock>
                                        </StackPanel>
                                        <StackPanel x:Name="spAuftragKopf2Data" Orientation="Horizontal">
                                            <TextBox Text="{Binding Path=anlagenpreis,StringFormat='{}{0:#,0.00}' }" TextAlignment="Right" />
                                            <TextBox Text="{Binding Path=auftragsspezifikation}" Width="600" Height="Auto" AcceptsReturn="True"/>
                                        </StackPanel>
                                        <StackPanel x:Name="spAuftragKopf2Label" Orientation="Horizontal">
                                            <TextBlock Text="Auftragspreis"  TextAlignment="Center"></TextBlock>
                                            <TextBlock Text="Auftragsspezifikation" TextAlignment="Center" ></TextBlock>
                                        </StackPanel>
                                    </StackPanel>
                                    <Expander Name="ExpKomponenten" Header="Komponenten">
                                        <StackPanel Name="StackKomponenten"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource AnlagenLieferzeit_ViewSource}}" Name="Komponenten_ListView"  SelectionMode="Single"
                                                        DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="AnlagenLieferzeit_GotFocus" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_Komponenten" >
                                                        <GridViewColumn   Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel>
                                                                        <StackPanel.Resources>
                                                                            <Style TargetType="TextBox"  >
                                                                                <Setter Property="Height" Value="24" />
                                                                                <Setter Property="FontFamily" Value="Calibri" />
                                                                                <Setter Property="FontSize" Value="14"/>
                                                                                <Setter Property="Margin" Value="3"/>
                                                                                <Setter Property="Width" Value="150" />
                                                                            </Style>
                                                                            <Style TargetType="TextBlock">
                                                                                <Setter Property="FontSize" Value="12" />
                                                                                <Setter Property="FontFamily" Value="Calibri" />
                                                                                <Setter Property="Width" Value="90" />
                                                                                <Setter Property="Margin" Value="2,5" />
                                                                                <Setter Property="TextAlignment" Value="Right"/>
                                                                            </Style>
                                                                            <Style TargetType="DatePicker">
                                                                                <Setter Property="Height" Value="24" />
                                                                                <Setter Property="Width" Value="150" />
                                                                                <Setter Property="Margin" Value="3" />
                                                                            </Style>
                                                                            <Style TargetType="CheckBox">
                                                                                <Setter Property="Margin" Value="3"/>
                                                                            </Style>
                                                                        </StackPanel.Resources>
                                                                        <StackPanel Height="Auto" Orientation="Horizontal">
                                                                            <TextBlock Text="Komponente"></TextBlock>
                                                                            <TextBox  Text="{Binding Path=nummer, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                                                                            <TextBlock>Typ/Nr</TextBlock>
                                                                            <TextBox  Text="{Binding Path=typ, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                                                                            <TextBlock>Storno</TextBlock>
                                                                            <DatePicker Margin="3" SelectedDate="{Binding Path=storno, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                        </StackPanel>
                                                                        <StackPanel Orientation="Horizontal">
                                                                            <TextBlock>Liefertermin</TextBlock>
                                                                            <DatePicker  SelectedDate="{Binding Path=lieferzeit, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                            <TextBlock>Versandt am</TextBlock>
                                                                            <DatePicker SelectedDate="{Binding Path=versandtam, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                            <TextBlock>Preis</TextBlock>
                                                                            <TextBox  Text="{Binding Path=preis, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,StringFormat=n}"/>
                                                                            <Button Name="cmdDeleteKomponente" Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                                                <Image Source="{StaticResource BitmapDelete}"/>
                                                                            </Button>
                                                                        </StackPanel>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="AddKomponenten" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14" Click="AddKomponenten_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                    <Expander Name="ExpProjektRechnung" Header="Rechnungen">
                                        <StackPanel Name="StackProjektRechnungen"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource ProjektRechnung_ViewSource}}" Name="ProjektRechnungen_ListView"  SelectionMode="Single"
                                                        DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="RechnungItem_GotFocus" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_ProjektRechnungen" >
                                                        <GridViewColumn   Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel>
                                                                        <StackPanel Orientation="Horizontal">
                                                                            <StackPanel Height="Auto">
                                                                                <controls:LabelAndDatepicker TextBlockText="Rechnungsdatum :" DatePickerDateTime="{Binding Path=rechnung, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                                <uc:LabelAndCurrency TextBlockText="Rechnungsbetrag :" TextBoxText="{Binding Path=betrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}'}"
                                                                                                     onTextBox_TextChanged="DoCalculateKommission"
                                                                                                     onGotKeyboardFocus="SelectAddress"
                                                                                                     onMouseDoubleClick="SelectAddress"
                                                                                                     onPreviewMouseLeftButtonDown="SelectivelyIgnoreMouseButton"/>
                                                                            </StackPanel>
                                                                            <StackPanel>
                                                                                <controls:LabelAndText TextBlockText="Rg-Nr :" TextBoxText="{Binding Path=rechnungnr, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                                                                <uc:LabelAndCurrency TextBlockText="Faktor :" TextBoxText="{Binding Path=faktor, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat='{}{0:0.00} %'}"
                                                                                                     onTextBox_TextChanged="DoCalculateKommission"
                                                                                                     onGotKeyboardFocus="SelectAddress"
                                                                                                     onMouseDoubleClick="SelectAddress"
                                                                                                     onPreviewMouseLeftButtonDown="SelectivelyIgnoreMouseButton"  />
                                                                            </StackPanel>
                                                                            <StackPanel>
                                                                                <controls:LabelAndText TextBlockText="int no. :" TextBoxText="{Binding Path=intno, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                                                                <controls:LabelAndCurrency TextBlockText="Kommission :" TextBoxText="{Binding Path=kommission, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,StringFormat='{}{0:#,0.00}'}"/>
                                                                            </StackPanel>
                                                                            <StackPanel>
                                                                                <controls:LabelAndDatepicker TextBlockText="fällig am :" DatePickerDateTime="{Binding Path=faelligam, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                <controls:BetragWaehrung TextBoxText="{Binding Path=kommissionbetragerhalten, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Kommission erhalten :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                         CBoxSelectedValue="{Binding Path=kommissionwaehrung,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                                                            </StackPanel>
                                                                            <StackPanel>
                                                                                <controls:LabelAndDatepicker TextBlockText="Storno :" DatePickerDateTime="{Binding Path=storno, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                                <controls:LabelAndDatepicker TextBlockText="Datum Komm. erh. :" DatePickerDateTime="{Binding Path=kommissionerhalten, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                            </StackPanel>
                                                                            <StackPanel>
                                                                                <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                                                                <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                      IsSynchronizedWithCurrentItem="False"
                                                                                      ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                      SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                      SelectedValuePath="id"
                                                                                      ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                                                                            </StackPanel>
                                                                            <Button Name="cmdDeleteProjektRechnungen" Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                                                <Image Source="{StaticResource BitmapDelete}"/>
                                                                            </Button>
                                                                        </StackPanel>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="AddProjektRechnung" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14"  Click="cmd_AddListViewItem_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                    <Expander Name="ExpErsatzteileGutschrift" Header="Gutschrift"
                                            Expanded="ExpErsatzteileGutschrift_Expanded">
                                        <StackPanel Name="StackErsatzteileGutschrift"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource ErsatzteileGutschrift_ViewSource}}" Name="ErsatzteileGutschrift_ListView"  SelectionMode="Single"
                                                        DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="ErsatzteileGutschrift_ListView_GotFocus" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_ErsatzteileGutschrift" >
                                                        <GridViewColumn   Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel Orientation="Horizontal" >
                                                                        <StackPanel>
                                                                            <controls:LabelAndDatepicker TextBlockText="Gutschrift :" DatePickerDateTime="{Binding Path=gutschrift, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                            <controls:LabelAndText TextBlockText="GS-Nr. :" TextBoxText="{Binding Path=gutschriftnr, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                                                                        </StackPanel>
                                                                        <StackPanel>
                                                                            <controls:BetragWaehrung TextBoxText="{Binding Path=gutschriftbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Gutschriftbetrag :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                         CBoxSelectedValue="{Binding Path=wkz,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                                                            <!--<controls:LabelAndCurrency TextBlockText="Betrag :" TextBoxText="{Binding Path=betrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,StringFormat='{}{0:#,0.00}'}"/>-->
                                                                            <controls:LabelAndCurrency TextBlockText="Kommission" TextBoxText="{Binding Path=kommission, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,StringFormat='{}{0:#,0.00}'}"/>
                                                                        </StackPanel>
                                                                        <StackPanel>
                                                                            <controls:LabelAndDatepicker TextBlockText="fällig :" DatePickerDateTime="{Binding Path=faelligam, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                            <controls:LabelAndDatepicker TextBlockText="Datum :" DatePickerDateTime="{Binding Path=kommissionerhalten, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                        </StackPanel>
                                                                        <controls:LabelAndCurrency TextBlockText="MWST Betrag :" TextBoxText="{Binding Path=mwstbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,StringFormat='{}{0:#,0.00}'}" />
                                                                        <StackPanel>
                                                                            <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                                                            <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                      IsSynchronizedWithCurrentItem="False"
                                                                                      ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                      SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                      SelectedValuePath="id"
                                                                                      ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                                                                        </StackPanel>
                                                                        <Button Name="cmdDeleteErsatzteileGutschrift" Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                                            <Image Source="{StaticResource BitmapDelete}"/>
                                                                        </Button>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="AddErsatzteileGutschrift" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14"  Click="cmd_AddListViewItem_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                    <Expander Name="ExpAusgangsRechnungen" Header="Ausgangsrechnungen">
                                        <StackPanel Name="StackAusgangsRechnungen"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource AusgangsRechnungen_ViewSource}}" Name="AusgangsRechnungen_ListView"  SelectionMode="Single"
                                         DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="AusgangsRechnungen_Listview_GotFocus" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_Rechnungen" >
                                                        <GridViewColumn   Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel Orientation="Horizontal" Height="Auto">
                                                                        <StackPanel.Resources>
                                                                            <Style TargetType="TextBox"  >
                                                                                <Setter Property="Height" Value="24" />
                                                                                <Setter Property="FontFamily" Value="Calibri" />
                                                                                <Setter Property="FontSize" Value="14"/>
                                                                                <Setter Property="Margin" Value="3"/>
                                                                                <Setter Property="Width" Value="150" />
                                                                            </Style>
                                                                            <Style TargetType="TextBlock">
                                                                                <Setter Property="FontSize" Value="12" />
                                                                                <Setter Property="FontFamily" Value="Calibri" />
                                                                                <Setter Property="Width" Value="90" />
                                                                                <Setter Property="Margin" Value="2,5" />
                                                                                <Setter Property="TextAlignment" Value="Right"/>
                                                                            </Style>
                                                                            <Style TargetType="DatePicker">
                                                                                <Setter Property="Height" Value="24" />
                                                                                <Setter Property="Width" Value="150" />
                                                                                <Setter Property="Margin" Value="3" />
                                                                            </Style>
                                                                            <Style TargetType="CheckBox">
                                                                                <Setter Property="Margin" Value="3"/>
                                                                            </Style>
                                                                        </StackPanel.Resources>
                                                                        <StackPanel>
                                                                            <controls:LabelAndText TextBlockText="Kundenname :" TextBoxText="{Binding Path=empfaenger, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                                                            <controls:LabelAndDatepicker TextBlockText="Rechnungsdatum :" DatePickerDateTime="{Binding Path=rgdatum, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                        </StackPanel>
                                                                        <StackPanel>
                                                                            <controls:LabelAndText TextBlockText="Rechnungs-Nr. :" TextBoxText="{Binding Path=rgnr, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                                                            <controls:LabelAndDatepicker TextBlockText="Rechnung fällig :" DatePickerDateTime="{Binding Path=faelligam, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                        </StackPanel>
                                                                        <StackPanel>
                                                                            <controls:BetragWaehrung TextBoxText="{Binding Path=rechnungsbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Rechnungsbetrag :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                        CBoxSelectedValue="{Binding Path=wkz,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                                                            <controls:LabelAndCurrency TextBlockText="gezahlter Betrag :" TextBoxText="{Binding Path=rechnungseingang, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" />
                                                                        </StackPanel>
                                                                        <StackPanel>
                                                                            <controls:LabelAndCurrency TextBlockText="MWST :" TextBoxText="{Binding Path=mwstbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='c', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" />
                                                                            <controls:LabelAndDatepicker TextBlockText="Rechnung bezahlt :" DatePickerDateTime="{Binding Path=bezahltam, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                        </StackPanel>
                                                                        <StackPanel>
                                                                            <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                                                            <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                      IsSynchronizedWithCurrentItem="False"
                                                                                      ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                      SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                      SelectedValuePath="id"
                                                                                      ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                                                                        </StackPanel>
                                                                        <Button Name="cmdDeleteAusgangsRechnungen" Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                                            <Image Source="{StaticResource BitmapDelete}"/>
                                                                        </Button>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="AddAusgangsRechnungen" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14"  Click="AddRechnungen_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                    <Expander Name="ExpAusgangsGutschriften" Header="AusgangsGutschriften">
                                        <StackPanel Name="StackAusgangsGutschriften"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource AusgangsGutschriften_ViewSource}}" Name="AusgangsGutschriften_ListView"  SelectionMode="Single"
                                         DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="AusgangsGutschriften_Listview_GotFocus" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_AusgangsGutschriften" >
                                                        <GridViewColumn   Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel Orientation="Horizontal" Height="Auto">
                                                                        <StackPanel.Resources>
                                                                            <Style TargetType="TextBox"  >
                                                                                <Setter Property="Height" Value="24" />
                                                                                <Setter Property="FontFamily" Value="Calibri" />
                                                                                <Setter Property="FontSize" Value="14"/>
                                                                                <Setter Property="Margin" Value="3"/>
                                                                                <Setter Property="Width" Value="150" />
                                                                            </Style>
                                                                            <Style TargetType="TextBlock">
                                                                                <Setter Property="FontSize" Value="12" />
                                                                                <Setter Property="FontFamily" Value="Calibri" />
                                                                                <Setter Property="Width" Value="90" />
                                                                                <Setter Property="Margin" Value="2,5" />
                                                                                <Setter Property="TextAlignment" Value="Right"/>
                                                                            </Style>
                                                                            <Style TargetType="DatePicker">
                                                                                <Setter Property="Height" Value="24" />
                                                                                <Setter Property="Width" Value="150" />
                                                                                <Setter Property="Margin" Value="3" />
                                                                            </Style>
                                                                            <Style TargetType="CheckBox">
                                                                                <Setter Property="Margin" Value="3"/>
                                                                            </Style>
                                                                        </StackPanel.Resources>
                                                                        <controls:LabelAndText TextBlockText="Kundenname :"  TextBoxText="{Binding Path=name, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                                                                        <controls:LabelAndText TextBlockText="Gutschrift-Nr. :"  TextBoxText="{Binding Path=nummer, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}"/>
                                                                        <controls:LabelAndDatepicker TextBlockText="Gutschrift-Datum :" DatePickerDateTime="{Binding Path=datum, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                        <controls:BetragWaehrung TextBoxText="{Binding Path=gutschriftbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Gutschriftbetrag :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                        CBoxSelectedValue="{Binding Path=wkz,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                                                        <controls:LabelAndCurrency TextBlockText="MWST Betrag :" TextBoxText="{Binding Path=mwstbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='c', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" />
                                                                        <controls:LabelAndDatepicker TextBlockText="Gutschrift beglichen :" DatePickerDateTime="{Binding Path=beglichen, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                        <StackPanel>
                                                                            <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                                                            <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                      IsSynchronizedWithCurrentItem="False"
                                                                                      ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                      SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                      SelectedValuePath="id"
                                                                                      ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                                                                        </StackPanel>
                                                                        <Button Name="cmdDeleteAusgangsGutschriften" Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                                            <Image Source="{StaticResource BitmapDelete}"/>
                                                                        </Button>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="AddAusgangsGutschriften" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14"  Click="cmd_AddListViewItem_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                    <Expander Name="ExpLieferantenRechnungen" Header="Lieferantenrechnung">
                                        <StackPanel Name="StackLieferantenRechnungen"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource LieferantenRechnungen_ViewSource}}" Name="LieferantenRechnungen_ListView"  SelectionMode="Single"
                                                        DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="LieferantenRechnungen_Listview_GotFocus" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_LieferantenRechnungen" >
                                                        <GridViewColumn   Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel>
                                                                        <!--<StackPanel.Resources>
                                                                            <Style TargetType="TextBox"  >
                                                                                <Setter Property="Height" Value="24" />
                                                                                <Setter Property="FontFamily" Value="Calibri" />
                                                                                <Setter Property="FontSize" Value="14"/>
                                                                                <Setter Property="Margin" Value="3"/>
                                                                                <Setter Property="Width" Value="150" />

                                                                            </Style>
                                                                            <Style TargetType="TextBlock">
                                                                                <Setter Property="FontSize" Value="12" />
                                                                                <Setter Property="FontFamily" Value="Calibri" />
                                                                                <Setter Property="Width" Value="105" />
                                                                                <Setter Property="Margin" Value="2,5" />
                                                                                <Setter Property="TextAlignment" Value="Center"/>
                                                                            </Style>
                                                                            <Style TargetType="DatePicker">
                                                                                <Setter Property="Height" Value="24" />
                                                                                <Setter Property="Width" Value="150" />
                                                                                <Setter Property="Margin" Value="3" />

                                                                            </Style>
                                                                            <Style TargetType="CheckBox">
                                                                                <Setter Property="Margin" Value="60,0,10,0"/>
                                                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                                                            </Style>
                                                                        </StackPanel.Resources>-->
                                                                        <StackPanel Orientation="Horizontal">
                                                                            <StackPanel Height="Auto" Orientation="Horizontal">
                                                                                <StackPanel>
                                                                                    <controls:LabelAndText TextBlockText="Lieferantenname :" TextBoxText="{Binding Path=lieferantname, StringFormat=\{0:N\}, Mode=TwoWay, UpdateSourceTrigger=LostFocus}" />
                                                                                    <controls:LabelAndDatepicker TextBlockText="Rechnungsdatum :" DatePickerDateTime="{Binding Path=rechnungsdatum, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:LabelAndText TextBlockText="Rechnungs Nr. :" TextBoxText="{Binding Path=rechnung,  Mode=TwoWay, UpdateSourceTrigger=LostFocus}" />
                                                                                    <controls:LabelAndDatepicker TextBlockText="fällig am :" DatePickerDateTime="{Binding Path=faellig, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:BetragWaehrung TextBoxText="{Binding Path=rechnungsbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Rechnungsbetrag :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                         CBoxSelectedValue="{Binding Path=wkz,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                                                                    <controls:LabelAndCurrency TextBlockText="gezahlter Betrag :" TextBoxText="{Binding Path=rechnungseingang, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:LabelAndCurrency TextBlockText="MWST :" TextBoxText="{Binding Path=mwstbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                                                                                    <controls:LabelAndDatepicker TextBlockText="bezahlt am :" DatePickerDateTime="{Binding Path=bezahlt, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                                </StackPanel>
                                                                                <Rectangle Width="5" Margin="15,0,15,0"/>
                                                                                <StackPanel>
                                                                                    <controls:LabelAndCurrency TextBlockText="EUST Betrag :" TextBoxText="{Binding Path=eustbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                                                                                    <controls:LabelAndDatepicker TextBlockText="EUST Datum :" DatePickerDateTime="{Binding Path=eustdatum, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:LabelAndCurrency TextBlockText="Gebühren :" TextBoxText="{Binding Path=gebuehr, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                                                                                    <controls:LabelAndCurrency TextBlockText="MWST Gebühren :"
                                                                                                    TextBoxText="{Binding Path=mwstaufgebuehr, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=LostFocus,StringFormat=c}" />
                                                                                </StackPanel>
                                                                                <StackPanel>
                                                                                    <controls:LabelAndCurrency TextBlockText="Zollgebühren :" TextBoxText="{Binding Path= zollgebuehren,Mode=TwoWay,UpdateSourceTrigger=LostFocus,StringFormat=c}"/>
                                                                                    <StackPanel>
                                                                                        <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                                                                        <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                      IsSynchronizedWithCurrentItem="False"
                                                                                      ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                      SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                      SelectedValuePath="id"
                                                                                      ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                                                                                    </StackPanel>
                                                                                </StackPanel>
                                                                            </StackPanel>
                                                                            <StackPanel Orientation="Vertical">
                                                                                <controls:LabelAndCheckbox TextBlockText="weiter zu berechnen :" CheckBoxChecked="{Binding Path=weiterberechnet, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                                <controls:LabelAndCheckbox TextBlockText="erledigt :" CheckBoxChecked="{Binding Path=erledigt, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}"/>
                                                                            </StackPanel>

                                                                            <Button Name="cmdDeleteLieferantenRechnungen" Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                                                <Image Source="{StaticResource BitmapDelete}"/>
                                                                            </Button>
                                                                        </StackPanel>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="AddLieferantenRechnungen" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14"  Click="cmd_AddListViewItem_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                    <Expander Name="ExpLieferantenGutschriften" Header="Lieferantengutschriften">
                                        <StackPanel Name="StackLieferantenGutschriften"  Height="Auto">
                                            <ListView  ItemsSource="{Binding Source= {StaticResource LieferantenGutschriften_ViewSource}}" Name="LieferantenGutschriften_ListView"  SelectionMode="Single"
                                                        DataContext="{Binding}">
                                                <ListView.ItemContainerStyle>
                                                    <Style TargetType="ListViewItem">
                                                        <Setter Property="Control.HorizontalContentAlignment" Value="Stretch" />
                                                        <Setter Property="Control.VerticalContentAlignment" Value="Stretch" />
                                                        <EventSetter Event="GotFocus" Handler="LieferantenGutschriften_ListView_GotFocus" />
                                                    </Style>
                                                </ListView.ItemContainerStyle>
                                                <ListView.View >
                                                    <GridView x:Name="DataGrid_LieferantenGutschriften" >
                                                        <GridViewColumn   Header="" Width="Auto">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <StackPanel>
                                                                        <StackPanel.Resources>
                                                                            <Style TargetType="TextBox"  >
                                                                                <Setter Property="Height" Value="24" />
                                                                                <Setter Property="FontFamily" Value="Calibri" />
                                                                                <Setter Property="FontSize" Value="14"/>
                                                                                <Setter Property="Margin" Value="3"/>
                                                                                <Setter Property="Width" Value="150" />
                                                                            </Style>
                                                                            <Style TargetType="TextBlock">
                                                                                <Setter Property="FontSize" Value="12" />
                                                                                <Setter Property="FontFamily" Value="Calibri" />
                                                                                <Setter Property="Width" Value="90" />
                                                                                <Setter Property="Margin" Value="2,5" />
                                                                                <Setter Property="TextAlignment" Value="Right"/>
                                                                            </Style>
                                                                            <Style TargetType="DatePicker">
                                                                                <Setter Property="Height" Value="24" />
                                                                                <Setter Property="Width" Value="150" />
                                                                                <Setter Property="Margin" Value="3" />
                                                                            </Style>
                                                                            <Style TargetType="CheckBox">
                                                                                <Setter Property="Margin" Value="3"/>
                                                                            </Style>
                                                                        </StackPanel.Resources>
                                                                        <StackPanel Height="Auto" Orientation="Horizontal">
                                                                            <StackPanel>
                                                                                <TextBlock>Lieferantenname :</TextBlock>
                                                                                <TextBox  Text="{Binding Path=name, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                                                            </StackPanel>
                                                                            <StackPanel>
                                                                                <TextBlock>Gutschrift-.Nr. :</TextBlock>
                                                                                <TextBox  Text="{Binding Path=nummer, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                                                            </StackPanel>
                                                                            <StackPanel>
                                                                                <TextBlock>Gutschrift Datum :</TextBlock>
                                                                                <DatePicker SelectedDate="{Binding Path=gutschriftdatum, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                            </StackPanel>
                                                                            <controls:BetragWaehrung TextBoxText="{Binding Path=gutschriftbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='{}{0:#,0.00}', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" TextBlockText="Gutschriftbetrag :"
                                                                                                        CBoxItemssource="{Binding Source={StaticResource WaehrungenLookUp}}"
                                                                                                         CBoxSelectedValue="{Binding Path=wkz,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                                                            <controls:LabelAndCurrency TextBlockText="MWST Betrag :" TextBoxText="{Binding Path=mwstbetrag, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,
                                                                                    UpdateSourceTrigger=LostFocus,StringFormat='C', ConverterCulture={x:Static gl:CultureInfo.CurrentCulture}}" />
                                                                            <StackPanel>
                                                                                <TextBlock>Gutschrift erhalten</TextBlock>
                                                                                <DatePicker SelectedDate="{Binding Path=erhalten, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true,UpdateSourceTrigger=PropertyChanged}" />
                                                                            </StackPanel>
                                                                            <StackPanel>
                                                                                <TextBlock Text="Kostenstelle : " Style="{StaticResource KostenstellenLabel}"/>
                                                                                <ComboBox Height="23" HorizontalAlignment="Left" Style="{StaticResource KostenstellenStyle}"
                                                                                      IsSynchronizedWithCurrentItem="False"
                                                                                      ItemsSource="{Binding Source={StaticResource KostenstellenLookUp}}" 
                                                                                      SelectedValue ="{Binding Path=id_Kostenstelle,Mode=TwoWay,NotifyOnSourceUpdated=True,NotifyOnTargetUpdated=True,UpdateSourceTrigger=PropertyChanged}" 
                                                                                      SelectedValuePath="id"
                                                                                      ItemTemplate="{StaticResource KostenstellenTemplate}"
                                                                                      />
                                                                            </StackPanel>
                                                                            <Button Name="cmdDeleteLieferantenGutschriften" Click="Delete_ListViewItem_Click" Style="{StaticResource StyleSymbol}">
                                                                                <Image Source="{StaticResource BitmapDelete}"/>
                                                                            </Button>
                                                                        </StackPanel>
                                                                    </StackPanel>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            <Button Name="AddLieferantenGutschriften" Width="30" Height="20" HorizontalAlignment="Left" FontSize="14"  Click="cmd_AddListViewItem_Click">
                                                <Image Source="{StaticResource BitmapPlus}" />
                                            </Button>
                                        </StackPanel>
                                    </Expander>
                                </StackPanel>
                            </Expander>
                        </Border>
                        <!--Service-->
                        <Border Name="brdService" Margin="10,0,0,3" BorderThickness="2" CornerRadius="10" BorderBrush="Blue">
                            <Expander Name="ExpService" Header="Service" Margin="10,0,0,0">
                                <StackPanel>
                                    <StackPanel>
                                        <TextBox Style="{StaticResource TextboxStaticData}" HorizontalAlignment="Left" Text="{Binding Path=anlagennummer}" Width="150" Margin="10,0,0,3"/>
                                        <TextBlock Text="Anlagennummer"  HorizontalAlignment="Left" Margin="10,0,0,0"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <CheckBox IsChecked ="{Binding Path=service, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" Margin="60,20,0,0" />
                                        <CheckBox IsChecked ="{Binding Path=teile, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" Margin="60,20,0,0" />
                                        <CheckBox IsChecked ="{Binding Path=claim, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" Margin="60,20,0,0" />
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Service" Margin="50,10,0,0"/>
                                        <TextBlock Text="Teile" Margin="50,10,0,0"/>
                                        <TextBlock Text="Claim" Margin="50,10,0,0"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" >
                                        <DatePicker Margin="10,10,0,0" SelectedDate="{Binding Path=servicetermin, Mode=TwoWay, ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                        <TextBox Style="{StaticResource TextboxStaticData}" HorizontalAlignment="Left" Text="{Binding Path=erfuellungsort}" Width="150" Margin="10,10,0,0"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="geplanter Service, Datum" Margin="10,10,0,0"/>
                                        <TextBlock Text="Erfüllungsort" Margin="47,10,0,0"/>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBox Style="{StaticResource TextboxStaticData}" HorizontalAlignment="Left" Text="{Binding Path=anfragebeschreibung}" Height="60" MinWidth="800" Width="Auto" Margin="10,10,0,0" AcceptsReturn="True"/>
                                        <TextBlock Text="Auftragsbeschreibung" Margin="10,10,0,0"/>
                                    </StackPanel>
                                    <StackPanel>
                                        <TextBox Style="{StaticResource TextboxStaticData}" HorizontalAlignment="Left" Text="{Binding Path=servicereport}" Height="60" MinWidth="800" Width="Auto" Margin="10,10,0,0" AcceptsReturn="True"/>
                                        <TextBlock Text="Service-Report" Margin="10,10,0,0"/>
                                    </StackPanel>
                                    <StackPanel  >
                                        <DatePicker Margin="10,10,0,0" HorizontalAlignment="Left" SelectedDate="{Binding Path=serviceauftragsbestaetigung, Mode=TwoWay,  ValidatesOnExceptions=true, NotifyOnValidationError=true}" />
                                        <TextBlock Text="Auftragsbestätigung, Datum" Margin="10,10,0,0"/>
                                    </StackPanel>
                                </StackPanel>
                            </Expander>
                        </Border>
                        <StackPanel Orientation="Horizontal">
                            <Button Name="SpeichernBelow" Click="Save_Click" Height="30" Width="120" Margin="10,5,3,5" Content="Speichern"></Button>
                            <Button Name="CloseBelow" Click="btnClose_Click" Height="30" Width="120" Margin="10,5,3,5" Content="Schließen"></Button>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Grid>
    </ScrollViewer>
</Page>
